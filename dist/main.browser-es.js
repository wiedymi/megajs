var e="undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,t=[],n=[],r="undefined"==typeof Uint8Array?Array:Uint8Array,a=!1;function o(){a=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,o=e.length;r<o;++r)t[r]=e[r],n[e.charCodeAt(r)]=r;n[45]=62,n[95]=63}function i(e){a||o();var t,s,d,p,u,h,c=e.length;if(0<c%4)throw new Error("Invalid string. Length must be a multiple of 4");u="="===e[c-2]?2:"="===e[c-1]?1:0,h=new r(3*c/4-u),d=0<u?c-4:c;var f=0;for(t=0,s=0;t<d;t+=4,s+=3)p=n[e.charCodeAt(t)]<<18|n[e.charCodeAt(t+1)]<<12|n[e.charCodeAt(t+2)]<<6|n[e.charCodeAt(t+3)],h[f++]=255&p>>16,h[f++]=255&p>>8,h[f++]=255&p;return 2===u?(p=n[e.charCodeAt(t)]<<2|n[e.charCodeAt(t+1)]>>4,h[f++]=255&p):1==u&&(p=n[e.charCodeAt(t)]<<10|n[e.charCodeAt(t+1)]<<4|n[e.charCodeAt(t+2)]>>2,h[f++]=255&p>>8,h[f++]=255&p),h}function s(e){return t[63&e>>18]+t[63&e>>12]+t[63&e>>6]+t[63&e]}function d(e,t,n){for(var r,a=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],a.push(s(r));return a.join("")}function l(e){a||o();for(var n,r=e.length,s=r%3,l="",p=[],u=16383,h=0,c=r-s;h<c;h+=u)p.push(d(e,h,h+u>c?c:h+u));return 1===s?(n=e[r-1],l+=t[n>>2],l+=t[63&n<<4],l+="=="):2===s&&(n=(e[r-2]<<8)+e[r-1],l+=t[n>>10],l+=t[63&n>>4],l+=t[63&n<<2],l+="="),p.push(l),p.join("")}function p(t,n,r,a,o){var l,p,u=Math.pow,h=8*o-a-1,c=(1<<h)-1,f=c>>1,g=-7,y=r?o-1:0,b=r?-1:1,d=t[n+y];for(y+=b,l=d&(1<<-g)-1,d>>=-g,g+=h;0<g;l=256*l+t[n+y],y+=b,g-=8);for(p=l&(1<<-g)-1,l>>=-g,g+=a;0<g;p=256*p+t[n+y],y+=b,g-=8);if(0===l)l=1-f;else{if(l===c)return p?NaN:(d?-1:1)*Infinity;p+=u(2,a),l-=f}return(d?-1:1)*p*u(2,l-a)}function u(t,n,r,a,o,l){var p,u,h,f=Math.pow,g=8*l-o-1,y=(1<<g)-1,b=y>>1,w=23===o?5.960464477539063e-8-6.617444900424222e-24:0,_=a?0:l-1,E=a?1:-1,d=!1?1:0;for(n=Math.abs(n),isNaN(n)||n===Infinity?(u=isNaN(n)?1:0,p=y):(p=Math.floor(Math.log(n)/Math.LN2),1>n*(h=f(2,-p))&&(p--,h*=2),n+=1<=p+b?w/h:w*f(2,1-b),2<=n*h&&(p++,h/=2),p+b>=y?(u=0,p=y):1<=p+b?(u=(n*h-1)*f(2,o),p+=b):(u=n*f(2,b-1)*f(2,o),p=0));8<=o;t[r+_]=255&u,_+=E,u/=256,o-=8);for(p=p<<o|u,g+=o;0<g;t[r+_]=255&p,_+=E,p/=256,g-=8);t[r+_-E]|=128*d}var h={}.toString,c=Array.isArray||function(e){return"[object Array]"==h.call(e)},f=50;y.TYPED_ARRAY_SUPPORT=!(e.TYPED_ARRAY_SUPPORT!==void 0)||e.TYPED_ARRAY_SUPPORT;function g(){return y.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function m(e,t){if(g()<t)throw new RangeError("Invalid typed array length");return y.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=y.prototype):(null===e&&(e=new y(t)),e.length=t),e}function y(e,t,n){if(!y.TYPED_ARRAY_SUPPORT&&!(this instanceof y))return new y(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return E(this,e)}return b(this,e,t,n)}y.poolSize=8192,y._augment=function(e){return e.__proto__=y.prototype,e};function b(e,t,n,r){if("number"==typeof t)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?x(e,t,n,r):"string"==typeof t?k(e,t,n):R(e,t)}y.from=function(e,t,n){return b(null,e,t,n)},y.TYPED_ARRAY_SUPPORT&&(y.prototype.__proto__=Uint8Array.prototype,y.__proto__=Uint8Array);function w(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");else if(0>e)throw new RangeError("\"size\" argument must not be negative")}function _(e,t,n,r){return w(t),0>=t?m(e,t):void 0===n?m(e,t):"string"==typeof r?m(e,t).fill(n,r):m(e,t).fill(n)}y.alloc=function(e,t,n){return _(null,e,t,n)};function E(e,t){if(w(t),e=m(e,0>t?0:0|I(t)),!y.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}y.allocUnsafe=function(e){return E(null,e)},y.allocUnsafeSlow=function(e){return E(null,e)};function k(e,t,n){if(("string"!=typeof n||""===n)&&(n="utf8"),!y.isEncoding(n))throw new TypeError("\"encoding\" must be a valid string encoding");var r=0|A(t,n);e=m(e,r);var a=e.write(t,n);return a!==r&&(e=e.slice(0,a)),e}function S(e,t){var n=0>t.length?0:0|I(t.length);e=m(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function x(e,t,n,r){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),y.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=y.prototype):e=S(e,t),e}function R(e,t){if(C(t)){var n=0|I(t.length);return(e=m(e,n),0===e.length)?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||pe(t.length)?m(e,0):S(e,t);if("Buffer"===t.type&&c(t.data))return S(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function I(e){if(e>=g())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g().toString(16)+" bytes");return 0|e}y.isBuffer=ue;function C(e){return!!(null!=e&&e._isBuffer)}y.compare=function(e,t){if(!C(e)||!C(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,o=Math.min(n,r);a<o;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},y.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},y.concat=function(e,t){if(!c(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return y.alloc(0);var n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=y.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var o=e[n];if(!C(o))throw new TypeError("\"list\" argument must be an Array of Buffers");o.copy(r,a),a+=o.length}return r};function A(e,t){if(C(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return oe(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return de(e).length;default:if(r)return oe(e).length;t=(""+t).toLowerCase(),r=!0;}}y.byteLength=A;function L(e,t,n){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return H(this,t,n);case"utf8":case"utf-8":return Y(this,t,n);case"ascii":return K(this,t,n);case"latin1":case"binary":return W(this,t,n);case"base64":return z(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0;}}y.prototype._isBuffer=!0;function B(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}y.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)B(this,t,t+1);return this},y.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)B(this,t,t+3),B(this,t+1,t+2);return this},y.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)B(this,t,t+7),B(this,t+1,t+6),B(this,t+2,t+5),B(this,t+3,t+4);return this},y.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?Y(this,0,e):L.apply(this,arguments)},y.prototype.equals=function(e){if(!C(e))throw new TypeError("Argument must be a Buffer");return this===e||0===y.compare(this,e)},y.prototype.inspect=function(){var e="",t=f;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},y.prototype.compare=function(e,t,n,r,a){if(!C(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),0>t||n>e.length||0>r||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,a>>>=0,this===e)return 0;for(var o=a-r,s=n-t,d=Math.min(o,s),l=this.slice(r,a),p=e.slice(t,n),u=0;u<d;++u)if(l[u]!==p[u]){o=l[u],s=p[u];break}return o<s?-1:s<o?1:0};function q(e,t,n,r,a){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),0>n&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(0>n)if(a)n=0;else return-1;if("string"==typeof t&&(t=y.from(t,r)),C(t))return 0===t.length?-1:T(e,t,n,r,a);if("number"==typeof t)return t&=255,y.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):T(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function T(e,t,n,r,a){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,d=e.length,l=t.length;if(void 0!==r&&(r=(r+"").toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(2>e.length||2>t.length)return-1;s=2,d/=2,l/=2,n/=2}var p;if(a){var u=-1;for(p=n;p<d;p++)if(o(e,p)!==o(t,-1===u?0:p-u))-1!==u&&(p-=p-u),u=-1;else if(-1===u&&(u=p),p-u+1===l)return u*s}else for(n+l>d&&(n=d-l),p=n;0<=p;p--){for(var h=!0,c=0;c<l;c++)if(o(e,p+c)!==o(t,c)){h=!1;break}if(h)return p}return-1}y.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},y.prototype.indexOf=function(e,t,n){return q(this,e,t,n,!0)},y.prototype.lastIndexOf=function(e,t,n){return q(this,e,t,n,!1)};function j(e,t,n,r){n=+n||0;var a=e.length-n;r?(r=+r,r>a&&(r=a)):r=a;var o=t.length;if(0!=o%2)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s,d=0;d<r;++d){if(s=parseInt(t.substr(2*d,2),16),isNaN(s))return d;e[n+d]=s}return d}function P(e,t,n,r){return le(oe(t,e.length-n),e,n,r)}function O(e,t,n,r){return le(ie(t),e,n,r)}function D(e,t,n,r){return O(e,t,n,r)}function M(e,t,n,r){return le(de(t),e,n,r)}function U(e,t,n,r){return le(se(t,e.length-n),e,n,r)}y.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a=this.length-t;if((void 0===n||n>a)&&(n=a),0<e.length&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return j(this,e,t,n);case"utf8":case"utf-8":return P(this,e,t,n);case"ascii":return O(this,e,t,n);case"latin1":case"binary":return D(this,e,t,n);case"base64":return M(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0;}},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function z(e,t,n){return 0===t&&n===e.length?l(e):l(e.slice(t,n))}function Y(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var o=e[a],s=null,d=239<o?4:223<o?3:191<o?2:1;if(a+d<=n){var l,p,u,h;1===d?128>o&&(s=o):2===d?(l=e[a+1],128==(192&l)&&(h=(31&o)<<6|63&l,127<h&&(s=h))):3===d?(l=e[a+1],p=e[a+2],128==(192&l)&&128==(192&p)&&(h=(15&o)<<12|(63&l)<<6|63&p,2047<h&&(55296>h||57343<h)&&(s=h))):4===d?(l=e[a+1],p=e[a+2],u=e[a+3],128==(192&l)&&128==(192&p)&&128==(192&u)&&(h=(15&o)<<18|(63&l)<<12|(63&p)<<6|63&u,65535<h&&1114112>h&&(s=h))):void 0}null===s?(s=65533,d=1):65535<s&&(s-=65536,r.push(55296|1023&s>>>10),s=56320|1023&s),r.push(s),a+=d}return N(r)}var F=4096;function N(e){var t=String.fromCharCode,n=e.length;if(n<=4096)return t.apply(String,e);for(var r="",a=0;a<n;)r+=t.apply(String,e.slice(a,a+=4096));return r}function K(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function W(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function H(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var a="",o=t;o<n;++o)a+=ae(e[o]);return a}function G(e,t,n){for(var r=e.slice(t,n),a="",o=0;o<r.length;o+=2)a+=String.fromCharCode(r[o]+256*r[o+1]);return a}y.prototype.slice=function(e,t){var n=this.length;e=~~e,t=t===void 0?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),t<e&&(t=e);var r;if(y.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=y.prototype;else{var a=t-e;r=new y(a,void 0);for(var o=0;o<a;++o)r[o]=this[o+e]}return r};function X(e,t,n){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}y.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||X(e,t,this.length);for(var r=this[e],a=1,o=0;++o<t&&(a*=256);)r+=this[e+o]*a;return r},y.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||X(e,t,this.length);for(var r=this[e+--t],a=1;0<t&&(a*=256);)r+=this[e+--t]*a;return r},y.prototype.readUInt8=function(e,t){return t||X(e,1,this.length),this[e]},y.prototype.readUInt16LE=function(e,t){return t||X(e,2,this.length),this[e]|this[e+1]<<8},y.prototype.readUInt16BE=function(e,t){return t||X(e,2,this.length),this[e]<<8|this[e+1]},y.prototype.readUInt32LE=function(e,t){return t||X(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},y.prototype.readUInt32BE=function(e,t){return t||X(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},y.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||X(e,t,this.length);for(var r=this[e],a=1,o=0;++o<t&&(a*=256);)r+=this[e+o]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*t)),r},y.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||X(e,t,this.length);for(var r=t,a=1,o=this[e+--r];0<r&&(a*=256);)o+=this[e+--r]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*t)),o},y.prototype.readInt8=function(e,t){return t||X(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},y.prototype.readInt16LE=function(e,t){t||X(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},y.prototype.readInt16BE=function(e,t){t||X(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},y.prototype.readInt32LE=function(e,t){return t||X(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},y.prototype.readInt32BE=function(e,t){return t||X(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},y.prototype.readFloatLE=function(e,t){return t||X(e,4,this.length),p(this,e,!0,23,4)},y.prototype.readFloatBE=function(e,t){return t||X(e,4,this.length),p(this,e,!1,23,4)},y.prototype.readDoubleLE=function(e,t){return t||X(e,8,this.length),p(this,e,!0,52,8)},y.prototype.readDoubleBE=function(e,t){return t||X(e,8,this.length),p(this,e,!1,52,8)};function V(e,t,n,r,a,o){if(!C(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(t>a||t<o)throw new RangeError("\"value\" argument is out of bounds");if(n+r>e.length)throw new RangeError("Index out of range")}y.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var a=Math.pow(2,8*n)-1;V(this,e,t,n,a,0)}var o=1,s=0;for(this[t]=255&e;++s<n&&(o*=256);)this[t+s]=255&e/o;return t+n},y.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var a=Math.pow(2,8*n)-1;V(this,e,t,n,a,0)}var o=n-1,s=1;for(this[t+o]=255&e;0<=--o&&(s*=256);)this[t+o]=255&e/s;return t+n},y.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,1,255,0),y.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1};function J(e,t,n,r){0>t&&(t=65535+t+1);for(var a=0,o=Math.min(e.length-n,2);a<o;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}y.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):J(this,e,t,!0),t+2},y.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):J(this,e,t,!1),t+2};function Q(e,t,n,r){0>t&&(t=4294967295+t+1);for(var a=0,o=Math.min(e.length-n,4);a<o;++a)e[n+a]=255&t>>>8*(r?a:3-a)}y.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Q(this,e,t,!0),t+4},y.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Q(this,e,t,!1),t+4},y.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);V(this,e,t,n,a-1,-a)}var o=0,s=1,d=0;for(this[t]=255&e;++o<n&&(s*=256);)0>e&&0===d&&0!==this[t+o-1]&&(d=1),this[t+o]=255&(e/s>>0)-d;return t+n},y.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);V(this,e,t,n,a-1,-a)}var o=n-1,s=1,d=0;for(this[t+o]=255&e;0<=--o&&(s*=256);)0>e&&0===d&&0!==this[t+o+1]&&(d=1),this[t+o]=255&(e/s>>0)-d;return t+n},y.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,1,127,-128),y.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},y.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):J(this,e,t,!0),t+2},y.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):J(this,e,t,!1),t+2},y.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,4,2147483647,-2147483648),y.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Q(this,e,t,!0),t+4},y.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||V(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),y.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Q(this,e,t,!1),t+4};function Z(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function $(e,t,n,r,a){return a||Z(e,t,n,4,34028234663852886e22,-34028234663852886e22),u(e,t,n,r,23,4),n+4}y.prototype.writeFloatLE=function(e,t,n){return $(this,e,t,!0,n)},y.prototype.writeFloatBE=function(e,t,n){return $(this,e,t,!1,n)};function ee(e,t,n,r,a){return a||Z(e,t,n,8,17976931348623157e292,-17976931348623157e292),u(e,t,n,r,52,8),n+8}y.prototype.writeDoubleLE=function(e,t,n){return ee(this,e,t,!0,n)},y.prototype.writeDoubleBE=function(e,t,n){return ee(this,e,t,!1,n)},y.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,o=r-n;if(this===e&&n<t&&t<r)for(a=o-1;0<=a;--a)e[a+t]=this[a+n];else if(1e3>o||!y.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},y.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);256>a&&(e=a)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!y.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=n===void 0?this.length:n>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=C(e)?e:oe(new y(e,r).toString()),d=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%d]}return this};var te=/[^+\/0-9A-Za-z-_]/g;function ne(e){if(e=re(e).replace(te,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function re(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function ae(e){return 16>e?"0"+e.toString(16):e.toString(16)}function oe(e,t){t=t||Infinity;for(var n,r=e.length,a=null,o=[],s=0;s<r;++s){if(n=e.charCodeAt(s),55295<n&&57344>n){if(!a){if(56319<n){-1<(t-=3)&&o.push(239,191,189);continue}else if(s+1===r){-1<(t-=3)&&o.push(239,191,189);continue}a=n;continue}if(56320>n){-1<(t-=3)&&o.push(239,191,189),a=n;continue}n=(a-55296<<10|n-56320)+65536}else a&&-1<(t-=3)&&o.push(239,191,189);if(a=null,128>n){if(0>(t-=1))break;o.push(n)}else if(2048>n){if(0>(t-=2))break;o.push(192|n>>6,128|63&n)}else if(65536>n){if(0>(t-=3))break;o.push(224|n>>12,128|63&n>>6,128|63&n)}else if(1114112>n){if(0>(t-=4))break;o.push(240|n>>18,128|63&n>>12,128|63&n>>6,128|63&n)}else throw new Error("Invalid code point")}return o}function ie(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function se(e,t){for(var n,r,a,o=[],s=0;s<e.length&&!(0>(t-=2));++s)n=e.charCodeAt(s),r=n>>8,a=n%256,o.push(a),o.push(r);return o}function de(e){return i(ne(e))}function le(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function pe(e){return e!==e}function ue(e){return null!=e&&(!!e._isBuffer||he(e)||ce(e))}function he(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function ce(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&he(e.slice(0,0))}function fe(){throw new Error("setTimeout has not been defined")}function ge(){throw new Error("clearTimeout has not been defined")}var me=fe,ye=ge;"function"==typeof e.setTimeout&&(me=setTimeout),"function"==typeof e.clearTimeout&&(ye=clearTimeout);function be(t){if(me===setTimeout)return setTimeout(t,0);if((me===fe||!me)&&setTimeout)return me=setTimeout,setTimeout(t,0);try{return me(t,0)}catch(n){try{return me.call(null,t,0)}catch(n){return me.call(this,t,0)}}}function we(t){if(ye===clearTimeout)return clearTimeout(t);if((ye===ge||!ye)&&clearTimeout)return ye=clearTimeout,clearTimeout(t);try{return ye(t)}catch(n){try{return ye.call(null,t)}catch(n){return ye.call(this,t)}}}var _e,Ee=[],ke=!1,Se=-1;function ve(){ke&&_e&&(ke=!1,_e.length?Ee=_e.concat(Ee):Se=-1,Ee.length&&xe())}function xe(){if(!ke){var e=be(ve);ke=!0;for(var t=Ee.length;t;){for(_e=Ee,Ee=[];++Se<t;)_e&&_e[Se].run();Se=-1,t=Ee.length}_e=null,ke=!1,we(e)}}function Re(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ee.push(new Ie(e,t)),1!==Ee.length||ke||be(xe)}function Ie(e,t){this.fun=e,this.array=t}Ie.prototype.run=function(){this.fun.apply(null,this.array)};var Ce="browser",Ae="browser",Le=!0,Be={},qe=[],Te="",je={},Pe={},Oe={};function De(){}var Me=De,Ue=De,ze=De,Ye=De,Fe=De,Ne=De,Ke=De;function We(){throw new Error("process.binding is not supported")}function He(){return"/"}function Ge(){throw new Error("process.chdir is not supported")}function Xe(){return 0}var Ve=e.performance||{},Je=Ve.now||Ve.mozNow||Ve.msNow||Ve.oNow||Ve.webkitNow||function(){return new Date().getTime()};function Qe(e){var t=Math.floor,n=1e-3*Je.call(Ve),r=t(n),a=t(0);return e&&(r-=e[0],a-=e[1],0>a&&(r--,a+=1e9)),[r,a]}var Ze=new Date;function $e(){var e=new Date;return(e-Ze)/1e3}var et={nextTick:Re,title:"browser",browser:Le,env:Be,argv:qe,version:Te,versions:je,on:Me,addListener:Ue,once:ze,off:Ye,removeListener:Fe,removeAllListeners:Ne,emit:Ke,binding:We,cwd:He,chdir:Ge,umask:Xe,hrtime:Qe,platform:Ae,release:Pe,config:Oe,uptime:$e},tt="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window;function nt(e,t){return t={exports:{}},e(t,t.exports),t.exports}var rt;function at(){}at.prototype=Object.create(null);function ot(){ot.init.call(this)}ot.EventEmitter=ot,ot.usingDomains=!1,ot.prototype.domain=void 0,ot.prototype._events=void 0,ot.prototype._maxListeners=void 0,ot.defaultMaxListeners=10,ot.init=function(){this.domain=null,ot.usingDomains&&rt.active&&!(this instanceof rt.Domain)&&(this.domain=rt.active),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new at,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ot.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this};function it(e){return void 0===e._maxListeners?ot.defaultMaxListeners:e._maxListeners}ot.prototype.getMaxListeners=function(){return it(this)};function st(e,t,n){if(t)e.call(n);else for(var r=e.length,a=yt(e,r),o=0;o<r;++o)a[o].call(n)}function dt(e,t,n,r){if(t)e.call(n,r);else for(var a=e.length,o=yt(e,a),s=0;s<a;++s)o[s].call(n,r)}function lt(e,t,n,r,a){if(t)e.call(n,r,a);else for(var o=e.length,s=yt(e,o),d=0;d<o;++d)s[d].call(n,r,a)}function pt(e,t,n,r,a,o){if(t)e.call(n,r,a,o);else for(var s=e.length,d=yt(e,s),l=0;l<s;++l)d[l].call(n,r,a,o)}function ut(e,t,n,r){if(t)e.apply(n,r);else for(var a=e.length,o=yt(e,a),s=0;s<a;++s)o[s].apply(n,r)}ot.prototype.emit=function(e){var t,n,r,a,o,s,d,l="error"===e;if(s=this._events,s)l=l&&null==s.error;else if(!l)return!1;if(d=this.domain,l){if(t=arguments[1],d)t||(t=new Error("Uncaught, unspecified \"error\" event")),t.domainEmitter=this,t.domain=d,t.domainThrown=!1,d.emit("error",t);else if(t instanceof Error)throw t;else{var p=new Error("Uncaught, unspecified \"error\" event. ("+t+")");throw p.context=t,p}return!1}if(n=s[e],!n)return!1;var u="function"==typeof n;switch(r=arguments.length,r){case 1:st(n,u,this);break;case 2:dt(n,u,this,arguments[1]);break;case 3:lt(n,u,this,arguments[1],arguments[2]);break;case 4:pt(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=Array(r-1),o=1;o<r;o++)a[o-1]=arguments[o];ut(n,u,this,a);}return!1&&d.exit(),!0};function ht(e,t,n,r){var a,o,i;if("function"!=typeof n)throw new TypeError("\"listener\" argument must be a function");if(o=e._events,o?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),i=o[t]):(o=e._events=new at,e._eventsCount=0),!i)i=o[t]=n,++e._eventsCount;else if("function"==typeof i?i=o[t]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),!i.warned&&(a=it(e),a&&0<a&&i.length>a)){i.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=i.length,ct(s)}return e}function ct(t){"function"==typeof console.warn?console.warn(t):console.log(t)}ot.prototype.addListener=function(e,t){return ht(this,e,t,!1)},ot.prototype.on=ot.prototype.addListener,ot.prototype.prependListener=function(e,t){return ht(this,e,t,!0)};function ft(e,t,n){function r(){e.removeListener(t,r),a||(a=!0,n.apply(e,arguments))}var a=!1;return r.listener=n,r}ot.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,ft(this,e,t)),this},ot.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,ft(this,e,t)),this},ot.prototype.removeListener=function(e,t){var n,r,a,o,s;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(r=this._events,!r)return this;if(n=r[e],!n)return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new at:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,o=n.length;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,a=o;break}if(0>a)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new at,this;delete r[e]}else mt(n,a);r.removeListener&&this.emit("removeListener",e,s||t)}return this},ot.prototype.removeAllListeners=function(e){var t,n;if(n=this._events,!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=new at,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new at:delete n[e]),this;if(0===arguments.length){for(var r,a=Object.keys(n),o=0;o<a.length;++o)r=a[o],"removeListener"===r||this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new at,this._eventsCount=0,this}if(t=n[e],"function"==typeof t)this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this},ot.prototype.listeners=function(e){var t,n,r=this._events;return r?(t=r[e],n=t?"function"==typeof t?[t.listener||t]:bt(t):[]):n=[],n},ot.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):gt.call(e,t)},ot.prototype.listenerCount=gt;function gt(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}ot.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};function mt(e,t){for(var r=t,a=r+1,o=e.length;a<o;r+=1,a+=1)e[r]=e[a];e.pop()}function yt(e,t){for(var n=Array(t);t--;)n[t]=e[t];return n}function bt(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}var wt="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var _t=wt,Et=/%[sdj%]/g;function kt(e){if(!Ft(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(It(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,a=r.length,o=(e+"").replace(Et,function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return r[n++]+"";case"%d":return+r[n++];case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e;}}),s=r[n];n<a;s=r[++n])o+=Ut(s)||!Ht(s)?" "+s:" "+It(s);return o}function St(t,n){function r(){if(!a){if(et.throwDeprecation)throw new Error(n);else et.traceDeprecation?console.trace(n):console.error(n);a=!0}return t.apply(this,arguments)}if(Kt(e.process))return function(){return St(t,n).apply(this,arguments)};if(!0===et.noDeprecation)return t;var a=!1;return r}var vt,xt={};function Rt(e){if(Kt(vt)&&(vt=et.env.NODE_DEBUG||""),e=e.toUpperCase(),!xt[e])if(new RegExp("\\b"+e+"\\b","i").test(vt)){xt[e]=function(){var t=kt.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else xt[e]=function(){};return xt[e]}function It(e,t){var n={seen:[],stylize:At};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),Mt(t)?n.showHidden=t:t&&rn(n,t),Kt(n.showHidden)&&(n.showHidden=!1),Kt(n.depth)&&(n.depth=2),Kt(n.colors)&&(n.colors=!1),Kt(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Ct),Bt(n,e,n.depth)}It.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},It.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Ct(e,t){var n=It.styles[t];return n?"\x1B["+It.colors[n][0]+"m"+e+"\x1B["+It.colors[n][1]+"m":e}function At(e){return e}function Lt(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function Bt(e,t,r){if(e.customInspect&&t&&Vt(t.inspect)&&t.inspect!==It&&!(t.constructor&&t.constructor.prototype===t)){var a=t.inspect(r,e);return Ft(a)||(a=Bt(e,a,r)),a}var o=qt(e,t);if(o)return o;var i=Object.keys(t),s=Lt(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),Xt(t)&&(0<=i.indexOf("message")||0<=i.indexOf("description")))return Tt(t);if(0===i.length){if(Vt(t)){var d=t.name?": "+t.name:"";return e.stylize("[Function"+d+"]","special")}if(Wt(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Gt(t))return e.stylize(Date.prototype.toString.call(t),"date");if(Xt(t))return Tt(t)}var l="",p=!1,u=["{","}"];if(Dt(t)&&(p=!0,u=["[","]"]),Vt(t)){var h=t.name?": "+t.name:"";l=" [Function"+h+"]"}if(Wt(t)&&(l=" "+RegExp.prototype.toString.call(t)),Gt(t)&&(l=" "+Date.prototype.toUTCString.call(t)),Xt(t)&&(l=" "+Tt(t)),0===i.length&&(!p||0==t.length))return u[0]+l+u[1];if(0>r)return Wt(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var n;return n=p?jt(e,t,r,s,i):i.map(function(n){return Pt(e,t,r,s,n,p)}),e.seen.pop(),Ot(n,l,u)}function qt(e,t){if(Kt(t))return e.stylize("undefined","undefined");if(Ft(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return e.stylize(n,"string")}return Yt(t)?e.stylize(""+t,"number"):Mt(t)?e.stylize(""+t,"boolean"):Ut(t)?e.stylize("null","null"):void 0}function Tt(e){return"["+Error.prototype.toString.call(e)+"]"}function jt(e,t,n,r,a){for(var o=[],s=0,d=t.length;s<d;++s)an(t,s+"")?o.push(Pt(e,t,n,r,s+"",!0)):o.push("");return a.forEach(function(a){a.match(/^\d+$/)||o.push(Pt(e,t,n,r,a,!0))}),o}function Pt(e,t,n,r,a,o){var i,s,d;if(d=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]},d.get?d.set?s=e.stylize("[Getter/Setter]","special"):s=e.stylize("[Getter]","special"):d.set&&(s=e.stylize("[Setter]","special")),an(r,a)||(i="["+a+"]"),s||(0>e.seen.indexOf(d.value)?(s=Ut(n)?Bt(e,d.value,null):Bt(e,d.value,n-1),-1<s.indexOf("\n")&&(o?s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),Kt(i)){if(o&&a.match(/^\d+$/))return s;i=JSON.stringify(""+a),i.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+s}function Ot(e,t,n){var r=e.reduce(function(e,t){if(0<=t.indexOf("\n"));return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return 60<r?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function Dt(e){return Array.isArray(e)}function Mt(e){return"boolean"==typeof e}function Ut(e){return null===e}function zt(e){return null==e}function Yt(e){return"number"==typeof e}function Ft(e){return"string"==typeof e}function Nt(e){return"symbol"==typeof e}function Kt(e){return void 0===e}function Wt(e){return Ht(e)&&"[object RegExp]"===Zt(e)}function Ht(e){return"object"==typeof e&&null!==e}function Gt(e){return Ht(e)&&"[object Date]"===Zt(e)}function Xt(t){return Ht(t)&&("[object Error]"===Zt(t)||t instanceof Error)}function Vt(e){return"function"==typeof e}function Jt(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function Qt(e){return ue(e)}function Zt(e){return Object.prototype.toString.call(e)}function $t(e){return 10>e?"0"+e.toString(10):e.toString(10)}var en=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function tn(){var e=new Date,t=[$t(e.getHours()),$t(e.getMinutes()),$t(e.getSeconds())].join(":");return[e.getDate(),en[e.getMonth()],t].join(" ")}function nn(){console.log("%s - %s",tn(),kt.apply(null,arguments))}function rn(e,t){if(!t||!Ht(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}function an(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var on={inherits:_t,_extend:rn,log:nn,isBuffer:Qt,isPrimitive:Jt,isFunction:Vt,isError:Xt,isDate:Gt,isObject:Ht,isRegExp:Wt,isUndefined:Kt,isSymbol:Nt,isString:Ft,isNumber:Yt,isNullOrUndefined:zt,isNull:Ut,isBoolean:Mt,isArray:Dt,inspect:It,deprecate:St,format:kt,debuglog:Rt},sn=/*#__PURE__*/Object.freeze({format:kt,deprecate:St,debuglog:Rt,inspect:It,isArray:Dt,isBoolean:Mt,isNull:Ut,isNullOrUndefined:zt,isNumber:Yt,isString:Ft,isSymbol:Nt,isUndefined:Kt,isRegExp:Wt,isObject:Ht,isDate:Gt,isError:Xt,isFunction:Vt,isPrimitive:Jt,isBuffer:Qt,log:nn,inherits:_t,_extend:rn,default:on});function dn(){this.head=null,this.tail=null,this.length=0}dn.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},dn.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},dn.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}},dn.prototype.clear=function(){this.head=this.tail=null,this.length=0},dn.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},dn.prototype.concat=function(e){if(0===this.length)return y.alloc(0);if(1===this.length)return this.head.data;for(var t=y.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t};var ln=y.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};function pn(e){if(e&&!ln(e))throw new Error("Unknown encoding: "+e)}function un(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),pn(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=cn;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=fn;break;default:return void(this.write=hn);}this.charBuffer=new y(6),this.charReceived=0,this.charLength=0}un.prototype.write=function(e){for(var t,n="";this.charLength;){if(t=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length,e.copy(this.charBuffer,this.charReceived,0,t),this.charReceived+=t,this.charReceived<this.charLength)return"";e=e.slice(t,e.length),n=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=n.charCodeAt(n.length-1);if(55296<=r&&56319>=r){this.charLength+=this.surrogateSize,n="";continue}if(this.charReceived=this.charLength=0,0===e.length)return n;break}this.detectIncompleteChar(e);var a=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,a),a-=this.charReceived),n+=e.toString(this.encoding,0,a);var a=n.length-1,r=n.charCodeAt(a);if(55296<=r&&56319>=r){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),n.substring(0,a)}return n},un.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var n=e[e.length-t];if(1==t&&6==n>>5){this.charLength=2;break}if(2>=t&&14==n>>4){this.charLength=3;break}if(3>=t&&30==n>>3){this.charLength=4;break}}this.charReceived=t},un.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,a=this.encoding;t+=r.slice(0,n).toString(a)}return t};function hn(e){return e.toString(this.encoding)}function cn(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function fn(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}wn.ReadableState=bn;var gn=Rt("stream");_t(wn,ot);function mn(e,t,n){return"function"==typeof e.prependListener?e.prependListener(t,n):void(e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n))}function yn(e,t){return e.listeners(t).length}function bn(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof v&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new dn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new un(e.encoding),this.encoding=e.encoding)}function wn(e){return this instanceof wn?void(this._readableState=new bn(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),ot.call(this)):new wn(e)}wn.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding,t!==n.encoding&&(e=y.from(e,t),t="")),_n(this,n,e,t,!1)},wn.prototype.unshift=function(e){var t=this._readableState;return _n(this,t,e,"",!0)},wn.prototype.isPaused=function(){return!1===this._readableState.flowing};function _n(t,n,r,a,o){var i=xn(n,r);if(i)t.emit("error",i);else if(null===r)n.reading=!1,Rn(t,n);else if(!(n.objectMode||r&&0<r.length))o||(n.reading=!1);else if(n.ended&&!o){var s=new Error("stream.push() after EOF");t.emit("error",s)}else if(n.endEmitted&&o){var e=new Error("stream.unshift() after end event");t.emit("error",e)}else{var d;!n.decoder||o||a||(r=n.decoder.write(r),d=!n.objectMode&&0===r.length),o||(n.reading=!1),d||(n.flowing&&0===n.length&&!n.sync?(t.emit("data",r),t.read(0)):(n.length+=n.objectMode?1:r.length,o?n.buffer.unshift(r):n.buffer.push(r),n.needReadable&&In(t))),An(t,n)}return En(n)}function En(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}wn.prototype.setEncoding=function(e){return this._readableState.decoder=new un(e),this._readableState.encoding=e,this};var kn=8388608;function Sn(e){return 8388608<=e?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function vn(e,t){return 0>=e||0===t.length&&t.ended?0:t.objectMode?1:e===e?(e>t.highWaterMark&&(t.highWaterMark=Sn(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0)):t.flowing&&t.length?t.buffer.head.data.length:t.length}wn.prototype.read=function(e){gn("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return gn("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?zn(this):In(this),null;if(e=vn(e,t),0===e&&t.ended)return 0===t.length&&zn(this),null;var a=t.needReadable;gn("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&(a=!0,gn("length less than watermark",a)),t.ended||t.reading?(a=!1,gn("reading or ended",a)):a&&(gn("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,!t.reading&&(e=vn(r,t)));var o;return o=0<e?On(e,t):null,null===o?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(!t.ended&&(t.needReadable=!0),r!==e&&t.ended&&zn(this)),null!==o&&this.emit("data",o),o};function xn(e,t){var n=null;return ue(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function Rn(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,In(e)}}function In(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(gn("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Re(Cn,e):Cn(e))}function Cn(e){gn("emit readable"),e.emit("readable"),Pn(e)}function An(e,t){t.readingMore||(t.readingMore=!0,Re(Ln,e,t))}function Ln(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(gn("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}wn.prototype._read=function(){this.emit("error",new Error("not implemented"))},wn.prototype.pipe=function(e,t){function n(e){gn("onunpipe"),e===p&&a()}function r(){gn("onend"),e.end()}function a(){gn("cleanup"),e.removeListener("close",s),e.removeListener("finish",d),e.removeListener("drain",f),e.removeListener("error",i),e.removeListener("unpipe",n),p.removeListener("end",r),p.removeListener("end",a),p.removeListener("data",o),g=!0,u.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&f()}function o(t){gn("ondata"),m=!1;var n=e.write(t);!1!==n||m||((1===u.pipesCount&&u.pipes===e||1<u.pipesCount&&-1!==Nn(u.pipes,e))&&!g&&(gn("false write response, pause",p._readableState.awaitDrain),p._readableState.awaitDrain++,m=!0),p.pause())}function i(t){gn("onerror",t),l(),e.removeListener("error",i),0===yn(e,"error")&&e.emit("error",t)}function s(){e.removeListener("finish",d),l()}function d(){gn("onfinish"),e.removeListener("close",s),l()}function l(){gn("unpipe"),p.unpipe(e)}var p=this,u=this._readableState;switch(u.pipesCount){case 0:u.pipes=e;break;case 1:u.pipes=[u.pipes,e];break;default:u.pipes.push(e);}u.pipesCount+=1,gn("pipe count=%d opts=%j",u.pipesCount,t);var h=!t||!1!==t.end,c=h?r:a;u.endEmitted?Re(c):p.once("end",c),e.on("unpipe",n);var f=Bn(p);e.on("drain",f);var g=!1,m=!1;return p.on("data",o),mn(e,"error",i),e.once("close",s),e.once("finish",d),e.emit("pipe",p),u.flowing||(gn("pipe resume"),p.resume()),e};function Bn(e){return function(){var t=e._readableState;gn("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Pn(e))}}wn.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<r;a++)n[a].emit("unpipe",this);return this}var o=Nn(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},wn.prototype.on=function(e,t){var n=ot.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&In(this,r):Re(qn,this))}return n},wn.prototype.addListener=wn.prototype.on;function qn(e){gn("readable nexttick read 0"),e.read(0)}wn.prototype.resume=function(){var e=this._readableState;return e.flowing||(gn("resume"),e.flowing=!0,Tn(this,e)),this};function Tn(e,t){t.resumeScheduled||(t.resumeScheduled=!0,Re(jn,e,t))}function jn(e,t){t.reading||(gn("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Pn(e),t.flowing&&!t.reading&&e.read(0)}wn.prototype.pause=function(){return gn("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(gn("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function Pn(e){var t=e._readableState;for(gn("flow",t.flowing);t.flowing&&null!==e.read(););}wn.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var a in e.on("end",function(){if(gn("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(a){if((gn("wrapped data"),t.decoder&&(a=t.decoder.write(a)),!(t.objectMode&&(null===a||void 0===a)))&&(t.objectMode||a&&a.length)){var o=n.push(a);o||(r=!0,e.pause())}}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));return Fn(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){gn("wrapped _read",t),r&&(r=!1,e.resume())},n},wn._fromList=On;function On(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=Dn(e,t.buffer,t.decoder),n}function Dn(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):e===t.head.data.length?r=t.shift():r=n?Mn(e,t):Un(e,t),r}function Mn(e,t){var r=t.head,a=1,o=r.data;for(e-=o.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(o+=s===i.length?i:i.slice(0,e),e-=s,0===e){s===i.length?(++a,t.head=r.next?r.next:t.tail=null):(t.head=r,r.data=i.slice(s));break}++a}return t.length-=a,o}function Un(e,t){var r=y.allocUnsafe(e),a=t.head,o=1;for(a.data.copy(r),e-=a.data.length;a=a.next;){var i=a.data,s=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,s),e-=s,0===e){s===i.length?(++o,t.head=a.next?a.next:t.tail=null):(t.head=a,a.data=i.slice(s));break}++o}return t.length-=o,r}function zn(e){var t=e._readableState;if(0<t.length)throw new Error("\"endReadable()\" called on non-empty stream");t.endEmitted||(t.ended=!0,Re(Yn,t,e))}function Yn(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function Fn(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function Nn(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}Gn.WritableState=Hn,_t(Gn,ot);function Kn(){}function Wn(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function Hn(e,t){Object.defineProperty(this,"buffer",{get:St(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof v&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){nr(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new lr(this)}Hn.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};function Gn(e){return this instanceof Gn||this instanceof v?void(this._writableState=new Hn(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),ot.call(this)):new Gn(e)}Gn.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Xn(e,t){var n=new Error("write after end");e.emit("error",n),Re(t,n)}function Vn(e,t,n,r){var a=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):!y.isBuffer(n)&&"string"!=typeof n&&void 0!==n&&!t.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),Re(r,o),a=!1),a}Gn.prototype.write=function(e,t,n){var r=this._writableState,a=!1;return"function"==typeof t&&(n=t,t=null),y.isBuffer(e)?t="buffer":!t&&(t=r.defaultEncoding),"function"!=typeof n&&(n=Kn),r.ended?Xn(this,n):Vn(this,r,e,n)&&(r.pendingcb++,a=Qn(this,r,e,t,n)),a},Gn.prototype.cork=function(){var e=this._writableState;e.corked++},Gn.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.finished&&!e.bufferProcessing&&e.bufferedRequest&&ar(this,e))},Gn.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function Jn(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=y.from(t,n)),t}function Qn(e,t,n,r,a){n=Jn(t,n,r),y.isBuffer(n)&&(r="buffer");var o=t.objectMode?1:n.length;t.length+=o;var i=t.length<t.highWaterMark;if(i||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new Wn(n,r,a),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else Zn(e,t,!1,o,n,r,a);return i}function Zn(e,t,n,r,a,o,i){t.writelen=r,t.writecb=i,t.writing=!0,t.sync=!0,n?e._writev(a,t.onwrite):e._write(a,o,t.onwrite),t.sync=!1}function $n(e,t,n,r,a){--t.pendingcb,n?Re(a,r):a(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function tr(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function nr(e,t){var n=e._writableState,r=n.sync,a=n.writecb;if(tr(n),t)$n(e,n,r,t,a);else{var o=or(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||ar(e,n),r?Re(er,e,n,o,a):er(e,n,o,a)}}function er(e,t,n,r){n||rr(e,t),t.pendingcb--,r(),sr(e,t)}function rr(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function ar(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,a=Array(r),o=t.corkedRequestsFree;o.entry=n;for(var i=0;n;)a[i]=n,n=n.next,i+=1;Zn(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new lr(t)}else{for(;n;){var s=n.chunk,d=n.encoding,l=n.callback,p=t.objectMode?1:s.length;if(Zn(e,t,!1,p,s,d,l),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}Gn.prototype._write=function(e,t,n){n(new Error("not implemented"))},Gn.prototype._writev=null,Gn.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&e!==void 0&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||dr(this,r,n)};function or(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function ir(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function sr(e,t){var n=or(t);return n&&(0===t.pendingcb?(ir(e,t),t.finished=!0,e.emit("finish")):ir(e,t)),n}function dr(e,t,n){t.ending=!0,sr(e,t),n&&(t.finished?Re(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function lr(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var a=r.callback;e.pendingcb--,a(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}_t(v,wn);for(var pr,ur=Object.keys(Gn.prototype),hr=0;hr<ur.length;hr++)pr=ur[hr],v.prototype[pr]||(v.prototype[pr]=Gn.prototype[pr]);function v(e){return this instanceof v?void(wn.call(this,e),Gn.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",cr)):new v(e)}function cr(){this.allowHalfOpen||this._writableState.ended||Re(fr,this)}function fr(e){e.end()}_t(yr,v);function gr(e){this.afterTransform=function(t,n){return mr(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function mr(e,t,n){var r=e._transformState;r.transforming=!1;var a=r.writecb;if(!a)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&n!==void 0&&e.push(n),a(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function yr(e){if(!(this instanceof yr))return new yr(e);v.call(this,e),this._transformState=new gr(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){br(t,e)}):br(t)})}yr.prototype.push=function(e,t){return this._transformState.needTransform=!1,v.prototype.push.call(this,e,t)},yr.prototype._transform=function(){throw new Error("Not implemented")},yr.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var a=this._readableState;(r.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},yr.prototype._read=function(){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};function br(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}_t(wr,yr);function wr(e){return this instanceof wr?void yr.call(this,e):new wr(e)}wr.prototype._transform=function(e,t,n){n(null,e)},_t(_r,ot),_r.Readable=wn,_r.Writable=Gn,_r.Duplex=v,_r.Transform=yr,_r.PassThrough=wr,_r.Stream=_r;function _r(){ot.call(this)}_r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&d.pause&&d.pause()}function r(){d.readable&&d.resume&&d.resume()}function a(){l||(l=!0,e.end())}function o(){l||(l=!0,"function"==typeof e.destroy&&e.destroy())}function i(e){if(s(),0===ot.listenerCount(this,"error"))throw e}function s(){d.removeListener("data",n),e.removeListener("drain",r),d.removeListener("end",a),d.removeListener("close",o),d.removeListener("error",i),e.removeListener("error",i),d.removeListener("end",s),d.removeListener("close",s),e.removeListener("close",s)}var d=this;d.on("data",n),e.on("drain",r),e._isStdio||t&&!1===t.end||(d.on("end",a),d.on("close",o));var l=!1;return d.on("error",i),e.on("error",i),d.on("end",s),d.on("close",s),e.on("close",s),e.emit("pipe",d),e};var Er=/*#__PURE__*/Object.freeze({default:_r,Readable:wn,Writable:Gn,Duplex:v,Transform:yr,PassThrough:wr,Stream:_r}),kr=Er&&_r||Er,Sr=nt(function(e,t){function n(e,t,n){function r(){for(;s.length&&!l.paused;){var e=s.shift();if(null===e)return l.emit("end");l.emit("data",e)}}function a(){l.writable=!1,t.call(l),!l.readable&&l.autoDestroy&&l.destroy()}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,i=!1,s=[],d=!1,l=new kr;return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(n&&!1===n.autoDestroy),l.write=function(t){return e.call(this,t),!l.paused},l.queue=l.push=function(e){return d?l:(null===e&&(d=!0),s.push(e),r(),l)},l.on("end",function(){l.readable=!1,!l.writable&&l.autoDestroy&&Re(function(){l.destroy()})}),l.end=function(e){if(!o)return o=!0,arguments.length&&l.write(e),a(),l},l.destroy=function(){if(!i)return i=!0,o=!0,s.length=0,l.writable=l.readable=!1,l.emit("close"),l},l.pause=function(){if(!l.paused)return l.paused=!0,l},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),r(),l.paused||l.emit("drain"),l},l}t=e.exports=n,n.through=n}),vr=["write","end","destroy"],xr=["resume","pause"],Rr=["data","close"],Ir=Array.prototype.slice,Cr=Lr;function Ar(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n)}function Lr(e,t){function n(t){i[t]=function(){return e[t].apply(e,arguments)}}function r(e){i[e]=function(){i.emit(e);var n=t[e];return n?n.apply(t,arguments):void t.emit(e)}}function a(){if(!s){s=!0;var e=Ir.call(arguments);e.unshift("end"),i.emit.apply(i,e)}}function o(e){i.emit("error",e)}var i=new kr,s=!1;return Ar(vr,n),Ar(xr,r),Ar(Rr,function(e){t.on(e,function(){var t=Ir.call(arguments);t.unshift(e),i.emit.apply(i,t)})}),t.on("end",a),e.on("drain",function(){i.emit("drain")}),e.on("error",o),t.on("error",o),i.writable=e.writable,i.readable=t.readable,i}var Br=/*#__PURE__*/Object.freeze({default:Cr,__moduleExports:Cr}),qr=nt(function(e,t){function n(e,t,n){function r(){for(;s.length&&!l.paused;){var e=s.shift();if(null===e)return l.emit("end");l.emit("data",e)}}function a(){l.writable=!1,t.call(l),!l.readable&&l.autoDestroy&&l.destroy()}e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,i=!1,s=[],d=!1,l=new kr;return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(n&&!1===n.autoDestroy),l.write=function(t){return e.call(this,t),!l.paused},l.queue=l.push=function(e){return d?l:(null===e&&(d=!0),s.push(e),r(),l)},l.on("end",function(){l.readable=!1,!l.writable&&l.autoDestroy&&Re(function(){l.destroy()})}),l.end=function(e){if(!o)return o=!0,arguments.length&&l.write(e),a(),l},l.destroy=function(){if(!i)return i=!0,o=!0,s.length=0,l.writable=l.readable=!1,l.emit("close"),l},l.pause=function(){if(!l.paused)return l.paused=!0,l},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),r(),l.paused||l.emit("drain"),l},l}t=e.exports=n,n.through=n}),Tr=/*#__PURE__*/Object.freeze({default:qr,__moduleExports:qr}),jr=Br&&Cr||Br,Pr=Tr&&qr||Tr,Or=function(){function e(t){2>t.length||(t[0].pipe(t[1]),e(t.slice(1)))}function t(){var e=[].slice.call(arguments);e.unshift("error"),o.emit.apply(o,e)}var n;if(n=1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:[].slice.call(arguments),0==n.length)return Pr();if(1==n.length)return n[0];var r=n[0],a=n[n.length-1],o=jr(r,a);e(n);for(var s=1;s<n.length-1;s++)n[s].on("error",t);return o};function Dr(e,t){const n=[];let r;e.on("data",function(e){n.push(e)}),e.on("end",function(){r||(r=!0,t(null,y.concat(n)))}),e.on("error",function(n){r||(r=!0,t(n))})}function Mr(e){let t;return Sr(function(n){t&&(n=y.concat([t,n]));const r=Math.floor(n.length/e)*e;r?n.length>r?(t=n.slice(r),this.emit("data",n.slice(0,r))):(t=void 0,this.emit("data",n)):t=t?y.concat([t,n]):n},function(){t&&this.emit("data",t),this.emit("end")})}function Ur(e){const t=[];let n=0;return Sr(e=>{t.push(e),n+=e.length},function(){e(n),t.forEach(this.emit.bind(this,"data")),this.emit("end")})}var zr={},Yr=/*#__PURE__*/Object.freeze({default:zr}),Fr=Yr&&zr||Yr,Nr=nt(function(e){!function(t){function n(e,t){if(t=t||{type:"Array"},"undefined"!=typeof et&&"number"==typeof et.pid)return r(e,t);var n=window.crypto||window.msCrypto;if(!n)throw new Error("Your browser does not support window.crypto.");return a(e,t)}function r(e,t){var n=Fr.randomBytes(e);switch(t.type){case"Array":return[].slice.call(n);case"Buffer":return n;case"Uint8Array":for(var r=new Uint8Array(e),a=0;a<e;++a)r[a]=n.readUInt8(a);return r;default:throw new Error(t.type+" is unsupported.");}}function a(e,t){var n=new Uint8Array(e),r=window.crypto||window.msCrypto;switch(r.getRandomValues(n),t.type){case"Array":return[].slice.call(n);case"Buffer":try{new y(1)}catch(t){throw new Error("Buffer not supported in this environment. Use Node.js or Browserify for browser support.")}return new y(n);case"Uint8Array":return n;default:throw new Error(t.type+" is unsupported.");}}e.exports?e.exports=n:t.secureRandom=n,n.randomArray=function(e){return n(e,{type:"Array"})},n.randomUint8Array=function(e){return n(e,{type:"Uint8Array"})},n.randomBuffer=function(e){return n(e,{type:"Buffer"})}}(tt)});class Kr{constructor(e){this._tables[0][0][0]||this._precompute();let t,n,r,a,o;const s=this._tables[0][4],d=this._tables[1],l=e.length;let p=1;if(4!==l&&6!==l&&8!==l)throw new Error("invalid aes key size");for(this._key=[a=e.slice(0),o=[]],t=l;t<4*l+28;t++)r=a[t-1],(0==t%l||8===l&&4==t%l)&&(r=s[r>>>24]<<24^s[255&r>>16]<<16^s[255&r>>8]<<8^s[255&r],0==t%l&&(r=r<<8^r>>>24^p<<24,p=p<<1^283*(p>>7))),a[t]=a[t-l]^r;for(n=0;t;n++,t--)r=a[3&n?t:t-4],o[n]=4>=t||4>n?r:d[0][s[r>>>24]]^d[1][s[255&r>>16]]^d[2][s[255&r>>8]]^d[3][s[255&r]]}encrypt(e){return this._crypt(e,0)}decrypt(e){return this._crypt(e,1)}_precompute(){const e=this._tables[0],t=this._tables[1],n=e[4],r=t[4];let a,o,l;const p=[],d=[];let u,h,c,f,g,m;for(a=0;256>a;a++)d[(p[a]=a<<1^283*(a>>7))^a]=a;for(o=l=0;!n[o];o^=u||1,l=d[l]||1)for(f=l^l<<1^l<<2^l<<3^l<<4,f=99^(f>>8^255&f),n[o]=f,r[f]=o,c=p[h=p[u=p[o]]],m=16843009*c^65537*h^257*u^16843008*o,g=257*p[f]^16843008*f,a=0;4>a;a++)e[a][o]=g=g<<24^g>>>8,t[a][f]=m=m<<24^m>>>8;for(a=0;5>a;a++)e[a]=e[a].slice(0),t[a]=t[a].slice(0)}_crypt(e,t){if(4!==e.length)throw new Error("invalid aes block size");const n=this._key[t];let r,o,s,l=e[0]^n[0],p=e[t?3:1]^n[1],u=e[2]^n[2],h=e[t?1:3]^n[3];const f=n.length/4-2;let g,m=4;const y=[0,0,0,0],w=this._tables[t],_=w[0],E=w[1],k=w[2],S=w[3],v=w[4];for(g=0;g<f;g++)r=_[l>>>24]^E[255&p>>16]^k[255&u>>8]^S[255&h]^n[m],o=_[p>>>24]^E[255&u>>16]^k[255&h>>8]^S[255&l]^n[m+1],s=_[u>>>24]^E[255&h>>16]^k[255&l>>8]^S[255&p]^n[m+2],h=_[h>>>24]^E[255&l>>16]^k[255&p>>8]^S[255&u]^n[m+3],m+=4,l=r,p=o,u=s;for(g=0;4>g;g++)y[t?3&-g:g]=v[l>>>24]<<24^v[255&p>>16]<<16^v[255&u>>8]<<8^v[255&h]^n[m++],r=l,l=p,p=u,u=h,h=r;return y}}Kr.prototype._tables=[[[],[],[],[],[]],[[],[],[],[],[]]];function Wr(e){let t,n,a,o=[2479122403,2108737444,3518906241,22203222];for(a=65536;a--;)for(n=0;n<e.length;n+=16){const r=[0,0,0,0];for(t=0;16>t;t+=4)t+n<e.length&&(r[t/4]=e.readInt32BE(t+n));o=new Kr(r).encrypt(o)}const s=y.allocUnsafe(16);for(t=0;4>t;t++)s.writeInt32BE(o[t],4*t);return s}function Hr(e,t,n){const r=y.from(t.s,"base64");window.crypto.subtle.importKey("raw",e,{name:"PBKDF2"},!1,"deriveKey").then(e=>window.crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:1e5,hash:{name:"SHA-512"}},e,256)).then(e=>{n(null,y.from(e))}).catch(n)}class Gr{constructor(e){if(16!==e.length)throw Error("Wrong key length. Key must be 128bit.");const t=[];for(let n=0;4>n;n++)t[n]=e.readInt32BE(4*n);this.aes=new Kr(t)}encryptCBC(e){let t,n,r=[0,0,0,0],a=[,,,,];for(t=0;t<e.length;t+=16){for(n=0;4>n;n++)a[n]=e.readUInt32BE(t+4*n)^r[n];for(r=this.aes.encrypt(a),n=0;4>n;n++)e.writeInt32BE(r[n],t+4*n)}}decryptCBC(e){let n,r,a=[0,0,0,0],o=[,,,,],s=[,,,,];for(n=0;n<e.length;n+=16){for(r=0;4>r;r++)o[r]=e.readUInt32BE(n+4*r);for(s=o,o=this.aes.decrypt(o),r=0;4>r;r++)e.writeInt32BE(o[r]^a[r],n+4*r);a=s}}stringhash(e){let t=[0,0,0,0];for(let n=0;n<e.length;n+=4)if(4>e.length-n){const r=e.length-n;t[3&n/4]^=e.readIntBE(n,r)<<8*(4-r)}else t[3&n/4]^=e.readInt32BE(n);for(let n=16384;n--;)t=this.aes.encrypt(t);const n=y.allocUnsafe(8);return n.writeInt32BE(t[0],0),n.writeInt32BE(t[2],4),n}encryptECB(e){let t=[];for(let n=0;n<e.length;n+=16)t[0]=e.readInt32BE(n),t[1]=e.readInt32BE(n+4),t[2]=e.readInt32BE(n+8),t[3]=e.readInt32BE(n+12),t=this.aes.encrypt(t),e.writeInt32BE(t[0],n),e.writeInt32BE(t[1],n+4),e.writeInt32BE(t[2],n+8),e.writeInt32BE(t[3],n+12);return e}decryptECB(e){let t=[];for(let n=0;n<e.length;n+=16)t[0]=e.readInt32BE(n),t[1]=e.readInt32BE(n+4),t[2]=e.readInt32BE(n+8),t[3]=e.readInt32BE(n+12),t=this.aes.decrypt(t),e.writeInt32BE(t[0],n),e.writeInt32BE(t[1],n+4),e.writeInt32BE(t[2],n+8),e.writeInt32BE(t[3],n+12);return e}}class Xr{constructor(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;this.aes=e,this.nonce=t.slice(0,8),this.increment=131072,this.posNext=this.increment,this.pos=0,this.ctr=y.alloc(16),this.nonce.copy(this.ctr,0),this.mac=y.alloc(16),this.nonce.copy(this.mac,0),this.nonce.copy(this.mac,8),this.macs=[],this.incrementCTR(n/16)}condensedMac(){this.mac&&(this.macs.push(this.mac),this.mac=void 0);let e=y.alloc(16);for(let t=0;t<this.macs.length;t++){for(let n=0;16>n;n++)e[n]^=this.macs[t][n];this.aes.encryptECB(e)}const t=y.allocUnsafe(8);return t.writeInt32BE(e.readInt32BE(0)^e.readInt32BE(4),0),t.writeInt32BE(e.readInt32BE(8)^e.readInt32BE(12),4),t}encrypt(e){for(let t=0;t<e.length;t+=16){const n=this.aes.encryptECB(y.from(this.ctr));for(let r=0;16>r;r++)this.mac[r]^=e[t+r],e[t+r]^=n[r];this.aes.encryptECB(this.mac),this.incrementCTR()}}decrypt(e){for(let t=0;t<e.length;t+=16){const n=this.aes.encryptECB(y.from(this.ctr));for(let r=0;16>r;r++)e[t+r]^=n[r],this.mac[r]^=e[t+r];this.aes.encryptECB(this.mac),this.incrementCTR()}}incrementCTR(){let e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;for(let t=0;t<e;t++)this.checkMacBounding();const t=this.ctr;let n,r=15;for(;0!==e;)n=(e+t[r])%256,e=Math.floor((e+t[r])/256),t[r]=n,r-=1,0>r&&(r=15)}checkMacBounding(){this.pos+=16,this.pos>=this.posNext&&(this.macs.push(y.from(this.mac)),this.nonce.copy(this.mac,0),this.nonce.copy(this.mac,8),1048576>this.increment&&(this.increment+=131072),this.posNext+=this.increment)}}function Vr(e){return"string"==typeof e?Qr(e):e}function Jr(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Qr(e){return y.from(e,"base64")}function Zr(e){return new Gr(ta(e).slice(0,16))}function $r(e){function t(){const t=i.condensedMac();a.key=na(e,t),this.emit("end")}let n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};const r=n.start||0;if(0!==r)throw Error("Encryption cannot start midstream otherwise MAC verification will fail.");e=Vr(e),e||(e=Nr(24)),e instanceof y||(e=y.from(e));let a=Sr(function(e){i.encrypt(e),this.emit("data",e)},t);if(24!==e.length)return Re(()=>{a.emit("error",Error("Wrong key length. Key must be 192bit."))});const o=new Gr(e.slice(0,16)),i=new Xr(o,e.slice(16),r);return a=Or(Mr(16),a),a}function ea(e){function t(){const t=i.condensedMac();return t.equals(e.slice(24))||n.disableVerification?void this.emit("end"):this.emit("error",Error("MAC verification failed"))}let n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};const r=n.start||0;if(0!==r&&(n.disableVerification=!0),0!=r%16)throw Error("start argument of megaDecrypt must be a multiple of 16");e=Vr(e);let a=Sr(function(e){i.decrypt(e),this.emit("data",e)},t);const o=Zr(e),i=new Xr(o,e.slice(16),r);return a=Or(Mr(16),a),a}function ta(e){const t=y.alloc(32);e.copy(t);for(let n=0;16>n;n++)t.writeUInt8(t.readUInt8(n)^t.readUInt8(16+n,!0),n);return t}function na(e,t){const n=y.alloc(32);e.copy(n),t.copy(n,24);for(let r=0;16>r;r++)n.writeUInt8(n.readUInt8(r)^n.readUInt8(16+r),r);return n}function ra(e,t){if(e.length!==t.length)return!1;const n=e.length;let r=0;for(let a=0;a<n;a++)r|=e[a]^t[a];return 0==r}const aa={},oa=28,ia=1<<oa,sa=ia-1,da=oa>>1,la=(1<<da)-1,pa=0.6931471805599453;function ua(e){const t=[];for(;0<e--;)t[e]=0;return t}function ha(e){let t=e.length;if(e[t-1])return e;for(;1<t&&0===e[t-1];)t--;return e.slice(0,t)}function ca(e){let r,a=1;return 0!=(r=e>>>16)&&(e=r,a+=16),0!=(r=e>>8)&&(e=r,a+=8),0!=(r=e>>4)&&(e=r,a+=4),0!=(r=e>>2)&&(e=r,a+=2),0!=(r=e>>1)&&(e=r,a+=1),a}function fa(e,t){const a=e.length,o=t.length;if(a<o)return fa(t,e);const i=[];let r=0,s=0;for(;s<o;s++)r+=e[s]+t[s],i[s]=r&sa,r>>>=oa;for(;s<a;s++)r+=e[s],i[s]=r&sa,r>>>=oa;return r&&(i[s]=r),i}function ga(e,t){const a=e.length,o=t.length;if(o>a)return[];if(o===a){if(t[o-1]>e[o-1])return[];if(1===o)return[e[0]-t[0]]}const i=[];let r,s=0;for(r=0;r<o;r++)s+=e[r]-t[r],i[r]=s&sa,s>>=oa;for(;r<a;r++)s+=e[r],i[r]=s&sa,s>>=oa;return s?[]:ha(i)}function ma(e,t,n,r,a){let o=n&la,i=n>>da,s=r&la,d=r>>da,p=i*s+d*o,u=o*s+((p&la)<<da)+e[t]+a;return e[t]=u&sa,a=i*d+(p>>da)+(u>>oa),a}function ya(e){let n,a,o=e.length,t=ua(2*o),r=0;for(n=0;n<o;n++){for(r=ma(t,2*n,e[n],e[n],0),a=n+1;a<o;a++)r=ma(t,n+a,2*e[a],e[n],r);t[n+o]=r}return ha(t)}function ba(e,a){let o,s,d,l=e.length,n=a.length,t=ua(l+n-1);for(s=0;s<n;s++){for(o=0,d=0;d<l;d++)o=ma(t,s+d,e[d],a[s],o);t[s+l]=o}return ha(t)}function wa(e,t,r){let a=0;for(;0<=t&&0<r--;)a=a*ia+e[t--];return a}function _a(e,r){var a=Math.floor;let o,s,d,l,p,u=e.length-1,h=r.length-1,t=u-h;if(u<h||u===h&&(e[u]<r[u]||0<u&&e[u]===r[u]&&e[u-1]<r[u-1]))return aa.q=[0],aa.mod=e,aa;if(u===h&&4>wa(e,h,2)/wa(r,h,2)){for(o=e.concat(),d=0;;){if(l=ga(o,r),0===l.length)break;o=l,d++}return aa.q=[d],aa.mod=o,aa}let c=a(Math.log(r[h])/pa)+1,f=oa-c;if(o=e.concat(),s=r.concat(),f){for(p=h;0<p;p--)s[p]=s[p]<<f&sa|s[p-1]>>c;for(s[0]=s[0]<<f&sa,o[u]&(sa<<c&sa)&&(o[++u]=0,t++),p=u;0<p;p--)o[p]=o[p]<<f&sa|o[p-1]>>c;o[0]=o[0]<<f&sa}let g,b=ua(t+1),w=ua(t).concat(s);for(;;){if(g=ga(o,w),0===g.length)break;b[t]++,o=g}let _,E=s[h],k=wa(s,h,2);for(p=u;p>h;p--){_=p-h-1,b[_]=p>=o.length?1:o[p]===E?sa:a(wa(o,p,2)/E);for(let e=wa(o,p,3);b[_]*k>e;)b[_]--;w=w.slice(1),g=ga(o,ba([b[_]],w)),0===g.length&&(b[_]--,g=ga(o,ba([b[_]],w))),o=g}if(f){for(p=0;p<o.length-1;p++)o[p]=o[p]>>f|o[p+1]<<c&sa;o[o.length-1]>>=f}return aa.q=ha(b),aa.mod=ha(o),aa}function Ea(e,t){let r,a=0;for(let o=e.length-1;0<=o;o--)r=e[o],a=((r>>da)+(a<<da))%t,a=((r&la)+(a<<da))%t;return a}function ka(e,t){if(1===t.length){if(1===e.length)return[e[0]%t[0]];if(t[0]<la)return[Ea(e,t[0])]}let n=_a(e,t);return n.mod}function Sa(e,t,a){let n=e.length-(t.length<<1);if(0<n)return Sa(e.slice(0,n).concat(Sa(e.slice(n),t,a)),t,a);let o,i=t.length+1,s=t.length-1,d=ba(e.slice(s),a).slice(i),l=e.slice(0,i),p=ba(d,t).slice(0,i),u=ga(l,p);0===u.length&&(l[i]=1,u=ga(l,p));for(let r=0;;r++){if(o=ga(u,t),0===o.length)break;if(u=o,3<=r)return Sa(u,t,a)}return u}function va(t,r,e){let o=t.concat(),i=r.length-1,s=2*e.length,d=ua(s+1);for(d[s]=1,d=_a(d,e).q,s=ca(r[i])-2;0<=i;i--){for(;0<=s;s-=1)o=Sa(ya(o),e,d),r[i]&1<<s&&(o=Sa(ba(o,t),e,d));s=oa-1}return o}function xa(e,n,r,a,o){let i=va(ka(e,r),ka(n,ga(r,[1])),r),s=va(ka(e,a),ka(n,ga(a,[1])),a),d=ga(s,i);return 0===d.length?(d=ga(i,s),d=ka(ba(d,o),a),d=ga(a,d)):d=ka(ba(d,o),a),fa(ba(d,r),i)}function Ra(e){let t,a=1,o=[0],r=0,i=256,s=e.length;if(2>s)return 0;let d=8*(s-2),n=256*e.charCodeAt(0)+e.charCodeAt(1);if(n>d||n<d-8)return 0;for(let l=0;l<d;l++)255<(i<<=1)&&(i=1,t=e.charCodeAt(--s)),a>sa&&(a=1,o[++r]=0),t&i&&(o[r]|=a),a<<=1;return o}function Ia(e){let t,a=1,o=0,i=[0],r=1,s=0,d=e.length*oa,l="";for(t=0;t<d;t++)e[o]&a&&(i[s]|=r),255<(r<<=1)&&(r=1,i[++s]=0),(a<<=1)>sa&&(a=1,o++);for(;0<=s&&0===i[s];)s--;for(t=0;t<=s;t++)l=String.fromCharCode(i[t])+l;return l}function Ca(e){const t=[];for(let n=0;4>n;n++){const r=(256*e[0]+e[1]+7>>3)+2;if(t[n]=Ra(e.toString("binary").substr(0,r)),"number"==typeof t[n]){if(4!=n||16<=e.length)return!1;break}e=e.slice(r)}return t}function Aa(e,t){const n=Ra(e.toString("binary")),r=Ia(xa(n,t[2],t[0],t[1],t[3]));return y.from(r,"binary")}const La="undefined"==typeof window?self:window;qa.log={trace:Da,debug:Da,info:Da,warn:Da,error:Da};const Ba=180000;function qa(e,t){if(!e)throw Error("No options given");let n=e.onResponse;if(e="string"==typeof e?{uri:e}:JSON.parse(JSON.stringify(e)),e.onResponse=n,e.verbose&&(qa.log=Ma()),e.url&&(e.uri=e.url,delete e.url),!e.uri&&""!==e.uri)throw Error("options.uri is a required argument");if("string"!=typeof e.uri)throw Error("options.uri must be a string");const r=["proxy","_redirectsFollowed","maxRedirects","followRedirect"];for(let n=0;n<r.length;n++)if(e[r[n]])throw Error("options."+r[n]+" is not supported");if(e.callback=t||Da,e.method=e.method||"GET",e.headers=e.headers||{},e.body=e.body||null,e.timeout=e.timeout||qa.DEFAULT_TIMEOUT,e.headers.host)throw Error("Options.headers.host is not supported");e.json&&(e.headers.accept=e.headers.accept||"application/json","GET"!==e.method&&(e.headers["content-type"]="application/json"),"boolean"==typeof e.json?"string"!=typeof e.body&&(e.body=JSON.stringify(e.body)):e.body=JSON.stringify(e.json));const a=e=>{const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};if(e.qs){const t="string"==typeof e.qs?e.qs:a(e.qs);e.uri=-1===e.uri.indexOf("?")?e.uri+"?"+t:e.uri+"&"+t}const o=e=>{const t={boundry:"-------------------------------"+Math.floor(1e9*Math.random())},n=[];for(let r in e)e.hasOwnProperty(r)&&n.push("--"+t.boundry+"\nContent-Disposition: form-data; name=\""+r+"\"\n\n"+e[r]+"\n");return n.push("--"+t.boundry+"--"),t.body=n.join(""),t.length=t.body.length,t.type="multipart/form-data; boundary="+t.boundry,t};if(e.form){if("string"==typeof e.form)throw Error("form name unsupported");if("POST"===e.method){const t=(e.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(e.headers["content-type"]=t,t){case"application/x-www-form-urlencoded":e.body=a(e.form).replace(/%20/g,"+");break;case"multipart/form-data":const n=o(e.form);e.body=n.body,e.headers["content-type"]=n.type;break;default:throw Error("unsupported encoding:"+t);}}}return e.onResponse=e.onResponse||Da,!0===e.onResponse&&(e.onResponse=t,e.callback=Da),!e.headers.authorization&&e.auth&&(e.headers.authorization="Basic "+y.from(e.auth.username+":"+e.auth.password,"utf-8").toString("base64")),"function"!=typeof fetch||"function"!=typeof ReadableStream&&La.XMLHttpRequest?ja(e):Pa(e)}let Ta=0;function ja(e){function t(){if(d)return qa.log.debug("Ignoring timed out state change",{state:o.readyState,id:o.id});if(qa.log.debug("State change",{state:o.readyState,id:o.id,timedOut:d}),o.readyState===La.XMLHttpRequest.OPENED)for(let t in qa.log.debug("Request started",{id:o.id}),e.headers)o.setRequestHeader(t,e.headers[t]);else o.readyState===La.XMLHttpRequest.HEADERS_RECEIVED?n():o.readyState===La.XMLHttpRequest.LOADING?(n(),r()):o.readyState===La.XMLHttpRequest.DONE&&(n(),r(),a())}function n(){if(!p.response){if(p.response=!0,qa.log.debug("Got response",{id:o.id,status:o.status}),clearTimeout(o.timeoutTimer),o.statusCode=o.status,i&&0===o.statusCode){const t=new Error("CORS request rejected: "+e.uri);return t.cors="rejected",p.loading=!0,p.end=!0,u.emit("error",t),e.callback(t,o)}e.onResponse(null,o)}}function r(){if(o.response){const e=o.responseText.substr(l);l+=e.length,0<e.length&&u.push(y.from(e,"ascii"))}p.loading||(p.loading=!0,qa.log.debug("Response body loading",{id:o.id}))}function a(){if(!p.end){if(p.end=!0,qa.log.debug("Request done",{id:o.id}),u.push(null),o.body=o.responseText,e.json)try{o.body=JSON.parse(o.responseText)}catch(t){return u.emit("error",t),e.callback(t,o)}e.callback(null,o,o.body)}}const o=new La.XMLHttpRequest,i=za(e.uri),s="withCredentials"in o;let d=!1,l=0;if(Ta+=1,o.seq_id=Ta,o.id=Ta+": "+e.method+" "+e.uri,o._id=o.id,i&&!s){const t=new Error("Browser does not support cross-origin request: "+e.uri);return t.cors="unsupported",e.callback(t,o)}o.timeoutTimer=setTimeout(function(){d=!0;const t=new Error("ETIMEDOUT");return t.code="ETIMEDOUT",t.duration=e.timeout,qa.log.error("Timeout",{id:o._id,milliseconds:e.timeout}),e.callback(t,o)},e.timeout);const p={response:!1,loading:!1,end:!1};o.overrideMimeType("text/plain; charset=x-user-defined"),o.onreadystatechange=t,o.open(e.method,e.uri,!0),i&&(o.withCredentials=!!e.withCredentials),o.send(e.body);const u=new _r.Readable;return u._read=Da,u}function Pa(e){const t={};Ta+=1,t.seq_id=Ta,t.id=Ta+": "+e.method+" "+e.uri,t._id=t.id,Ta+=1;const n={};e.headers&&(n.headers=e.headers),e.method&&(n.method=e.method),e.body&&(n.body=e.body);const r=new _r.Readable;return r._read=Da,La.fetch(e.uri||e.url,n).then(n=>{function a(){o.read().then(function(e){e.done?r.push(null):(r.push(y.from(e.value)),a())})}t.statusCode=t.status=n.status,r.emit("response",{statusCode:n.status,statusMessage:n.statusText,headers:Array.from(n.headers).reduce((e,t)=>{let[n,r]=t;return e[n]=r,e},{})}),e.callback&&n.clone()[e.json?"json":"text"]().then(n=>e.callback(null,t,n)).catch(t=>e.callback(t));const o=n.body.getReader();a()},t=>{r.emit("error",t),e.callback(t)}),r}qa.withCredentials=!1,qa.DEFAULT_TIMEOUT=180000,qa.defaults=e=>{const t=t=>{return(n,r)=>{for(let t in n="string"==typeof n?{uri:n}:JSON.parse(JSON.stringify(n)),e)void 0===n[t]&&(n[t]=e[t]);return t(n,r)}},n=t(qa);return n.get=t(qa.get),n.post=t(qa.post),n.put=t(qa.put),n.head=t(qa.head),n};const Oa=["get","put","post","head"];Oa.forEach(function(e){const t=e.toUpperCase(),n=e.toLowerCase();qa[n]=function(e){"string"==typeof e?e={method:t,uri:e}:(e=JSON.parse(JSON.stringify(e)),e.method=t);const n=[e].concat(Array.prototype.slice.apply(arguments,[1]));return qa.apply(this,n)}});function Da(){}function Ma(){const e={},t=["trace","debug","info","warn","error"];let n,r;for(r=0;r<t.length;r++)n=t[r],e[n]=Da,"undefined"!=typeof console&&console&&console[n]&&(e[n]=Ua(console,n));return e}function Ua(e,t){return function(n,r){return"object"==typeof r&&(n+=" "+JSON.stringify(r)),e[t](n)}}function za(e){const t=/^([\w+.-]+:)(?:\/\/([^/?#:]*)(?::(\d+))?)?/;let n;try{n=La.location.href}catch(t){n=document.createElement("a"),n.href="",n=n.href}const r=t.exec(n.toLowerCase())||[],a=t.exec(e.toLowerCase()),o=!!(a&&(a[1]!==r[1]||a[2]!==r[2]||(a[3]||("http:"===a[1]?80:443))!==(r[3]||("http:"===r[1]?80:443))));return o}function Ya(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Fa=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function Na(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return"";}}function Ka(e,t,n,r){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Wa(Ha(e),function(r){var a=encodeURIComponent(Na(r))+n;return Fa(e[r])?Wa(e[r],function(e){return a+encodeURIComponent(Na(e))}).join(t):a+encodeURIComponent(Na(e[r]))}).join(t):r?encodeURIComponent(Na(r))+n+encodeURIComponent(Na(e)):""}function Wa(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var Ha=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t};function Ga(e,t,n,r){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var o=/\+/g;e=e.split(t);var s=1e3;r&&"number"==typeof r.maxKeys&&(s=r.maxKeys);var d=e.length;0<s&&d>s&&(d=s);for(var l=0;l<d;++l){var p,u,h,c,f=e[l].replace(o,"%20"),g=f.indexOf(n);0<=g?(p=f.substr(0,g),u=f.substr(g+1)):(p=f,u=""),h=decodeURIComponent(p),c=decodeURIComponent(u),Ya(a,h)?Fa(a[h])?a[h].push(c):a[h]=[a[h],c]:a[h]=c}return a}var Xa={encode:Ka,stringify:Ka,decode:Ga,parse:Ga};const Va=4,Ja={1:"EINTERNAL (-1): An internal error has occurred. Please submit a bug report, detailing the exact circumstances in which this error occurred.",2:"EARGS (-2): You have passed invalid arguments to this command.",3:"EAGAIN (-3): A temporary congestion or server malfunction prevented your request from being processed. No data was altered. Retried 4 times.",4:"ERATELIMIT (-4): You have exceeded your command weight per time quota. Please wait a few seconds, then try again (this should never happen in sane real-life applications).",5:"EFAILED (-5): The upload failed. Please restart it from scratch.",6:"ETOOMANY (-6): Too many concurrent IP addresses are accessing this upload target URL.",7:"ERANGE (-7): The upload file packet is out of range or not starting and ending on a chunk boundary.",8:"EEXPIRED (-8): The upload target URL you are trying to access has expired. Please request a fresh one.",9:"ENOENT (-9): Object (typically, node or user) not found. Wrong password?",10:"ECIRCULAR (-10): Circular linkage attempted",11:"EACCESS (-11): Access violation (e.g., trying to write to a read-only share)",12:"EEXIST (-12): Trying to create an object that already exists",13:"EINCOMPLETE (-13): Trying to access an incomplete resource",14:"EKEY (-14): A decryption operation failed (never returned by the API)",15:"ESID (-15): Invalid or expired user session, please relogin",16:"EBLOCKED (-16): User blocked",17:"EOVERQUOTA (-17): Request over quota",18:"ETEMPUNAVAIL (-18): Resource temporarily not available, please try again later"},Qa="https://eu.api.mega.co.nz/";class Za extends ot{constructor(e){super(),this.keepalive=e,this.counterId=Math.random().toString().substr(2,10),this.gateway=Qa,this.requestModule=qa}request(e,t){let n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;const r={id:(this.counterId++).toString()};this.sid&&(r.sid=this.sid),"object"==typeof e._querystring&&(Object.assign(r,e._querystring),delete e._querystring),this.requestModule({uri:"".concat(this.gateway,"cs"),qs:r,method:"POST",json:[e],gzip:!0},(r,a,o)=>{if(r)return t(r);if(!o)return t(Error("Empty response"));if(o.length&&(o=o[0]),!r&&"number"==typeof o&&0>o){if(-3===o&&4>n)return setTimeout(()=>{this.request(e,t,n+1)},1e3*Math.pow(2,n+1));r=Error(Ja[-o])}else this.keepalive&&o&&o.sn&&this.pull(o.sn);t(r,o)})}pull(e){let t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;this.sn=this.requestModule({uri:"".concat(this.gateway,"sc"),qs:{sn:e,sid:this.sid},method:"POST",json:!0,body:"sc?".concat(Xa.stringify({sn:e}))},(n,r,a)=>{if(this.sn=void 0,!n&&"number"==typeof a&&0>a){if(-3===a&&4>t)return setTimeout(()=>{this.pull(e,t+1)},1e3*Math.pow(2,t+1));n=Error(Ja[-a])}if(n)throw n;a.w?this.wait(a.w,e):a.sn&&(a.a&&this.emit("sc",a.a),this.pull(a.sn))})}wait(e,t){this.sn=this.requestModule({uri:e,method:"POST"},e=>{if(this.sn=void 0,e)throw Error("mega server wait req failed");this.pull(t)})}close(){this.sn&&this.sn.abort()}}var $a=sn&&on||sn,eo=kr.Stream,to=no;function no(){this.source=null,this.dataSize=0,this.maxDataSize=1048576,this.pauseStream=!0,this._maxDataSizeExceeded=!1,this._released=!1,this._bufferedEvents=[]}$a.inherits(no,eo),no.create=function(e,t){var n=new this;for(var r in t=t||{},t)n[r]=t[r];n.source=e;var a=e.emit;return e.emit=function(){return n._handleEmit(arguments),a.apply(e,arguments)},e.on("error",function(){}),n.pauseStream&&e.pause(),n},Object.defineProperty(no.prototype,"readable",{configurable:!0,enumerable:!0,get:function(){return this.source.readable}}),no.prototype.setEncoding=function(){return this.source.setEncoding.apply(this.source,arguments)},no.prototype.resume=function(){this._released||this.release(),this.source.resume()},no.prototype.pause=function(){this.source.pause()},no.prototype.release=function(){this._released=!0,this._bufferedEvents.forEach(function(e){this.emit.apply(this,e)}.bind(this)),this._bufferedEvents=[]},no.prototype.pipe=function(){var e=eo.prototype.pipe.apply(this,arguments);return this.resume(),e},no.prototype._handleEmit=function(e){return this._released?void this.emit.apply(this,e):void("data"===e[0]&&(this.dataSize+=e[1].length,this._checkIfMaxDataSizeExceeded()),this._bufferedEvents.push(e))},no.prototype._checkIfMaxDataSizeExceeded=function(){if(!this._maxDataSizeExceeded&&!(this.dataSize<=this.maxDataSize)){this._maxDataSizeExceeded=!0;var e="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this.emit("error",new Error(e))}};var ro=/*#__PURE__*/Object.freeze({default:to,__moduleExports:to}),ao=ro&&to||ro,oo=kr.Stream,io=so;function so(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2097152,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null}$a.inherits(so,oo),so.create=function(e){var t=new this;for(var n in e=e||{},e)t[n]=e[n];return t},so.isStreamLike=function(e){return"function"!=typeof e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e&&!ue(e)},so.prototype.append=function(e){var t=so.isStreamLike(e);if(t){if(!(e instanceof ao)){var n=ao.create(e,{maxDataSize:Infinity,pauseStream:this.pauseStreams});e.on("data",this._checkDataSize.bind(this)),e=n}this._handleErrors(e),this.pauseStreams&&e.pause()}return this._streams.push(e),this},so.prototype.pipe=function(e,t){return oo.prototype.pipe.call(this,e,t),this.resume(),e},so.prototype._getNext=function(){this._currentStream=null;var e=this._streams.shift();if("undefined"==typeof e)return void this.end();if("function"!=typeof e)return void this._pipeNext(e);e(function(e){var t=so.isStreamLike(e);t&&(e.on("data",this._checkDataSize.bind(this)),this._handleErrors(e)),this._pipeNext(e)}.bind(this))},so.prototype._pipeNext=function(e){this._currentStream=e;var t=so.isStreamLike(e);if(t)return e.on("end",this._getNext.bind(this)),void e.pipe(this,{end:!1});this.write(e),this._getNext()},so.prototype._handleErrors=function(e){var t=this;e.on("error",function(e){t._emitError(e)})},so.prototype.write=function(e){this.emit("data",e)},so.prototype.pause=function(){this.pauseStreams&&(this.pauseStreams&&this._currentStream&&"function"==typeof this._currentStream.pause&&this._currentStream.pause(),this.emit("pause"))},so.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.pauseStreams&&this._currentStream&&"function"==typeof this._currentStream.resume&&this._currentStream.resume(),this.emit("resume")},so.prototype.end=function(){this._reset(),this.emit("end")},so.prototype.destroy=function(){this._reset(),this.emit("close")},so.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null},so.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var e="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(new Error(e))}},so.prototype._updateDataSize=function(){this.dataSize=0;var e=this;this._streams.forEach(function(t){t.dataSize&&(e.dataSize+=t.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)},so.prototype._emitError=function(e){this._reset(),this.emit("error",e)};var lo=2147483647,po=36,uo=1,ho=26,co=38,fo=700,go=72,mo=128,yo="-",bo=/[^\x20-\x7E]/,wo=/[\x2E\u3002\uFF0E\uFF61]/g,_o={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Eo=po-uo,ko=Math.floor,So=String.fromCharCode;function vo(e){throw new RangeError(_o[e])}function xo(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function Ro(e,t){var n=e.split("@"),r="";1<n.length&&(r=n[0]+"@",e=n[1]),e=e.replace(wo,".");var a=e.split("."),o=xo(a,t).join(".");return r+o}function Io(e){for(var t,n,r=[],a=0,o=e.length;a<o;)t=e.charCodeAt(a++),55296<=t&&56319>=t&&a<o?(n=e.charCodeAt(a++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),a--)):r.push(t);return r}function Co(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function Ao(e,t,n){var r=0;for(e=n?ko(e/fo):e>>1,e+=ko(e/t);e>Eo*ho>>1;r+=po)e=ko(e/Eo);return ko(r+(Eo+1)*e/(e+co))}function Lo(e){var r,a,o,i,s,d,l,p,u,h,c,f,g,y,b,w=[];for(e=Io(e),f=e.length,r=mo,a=0,s=go,d=0;d<f;++d)c=e[d],128>c&&w.push(So(c));for(o=i=w.length,i&&w.push(yo);o<f;){for(l=2147483647,d=0;d<f;++d)c=e[d],c>=r&&c<l&&(l=c);for(g=o+1,l-r>ko((2147483647-a)/g)&&vo("overflow"),a+=(l-r)*g,r=l,d=0;d<f;++d)if(c=e[d],c<r&&2147483647<++a&&vo("overflow"),c==r){for(p=a,u=po;;u+=po){if(h=u<=s?uo:u>=s+ho?ho:u-s,p<h)break;b=p-h,y=po-h,w.push(So(Co(h+b%y,0))),p=ko(b/y)}w.push(So(Co(p,0))),s=Ao(a,g,o==i),a=0,++o}++a,++r}return w.join("")}function Bo(e){return Ro(e,function(e){return bo.test(e)?"xn--"+Lo(e):e})}function qo(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var To=/^([a-z0-9.+-]+:)/i,jo=/:[0-9]*$/,Po=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Oo=["<",">","\"","`"," ","\r","\n","\t"],Do=["{","}","|","\\","^","`"].concat(Oo),Mo=["'"].concat(Do),Uo=["%","/","?",";","#"].concat(Mo),zo=["/","?","#"],Yo=255,Fo=/^[+a-z0-9A-Z_-]{0,63}$/,No=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ko={javascript:!0,"javascript:":!0},Wo={javascript:!0,"javascript:":!0},Ho={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Go(e,t,n){if(e&&Ht(e)&&e instanceof qo)return e;var r=new qo;return r.parse(e,t,n),r}qo.prototype.parse=function(e,t,n){return Xo(this,e,t,n)};function Xo(e,t,n,r){if(!Ft(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var a=t.indexOf("?"),o=-1!==a&&a<t.indexOf("#")?"?":"#",d=t.split(o),u=/\\/g;d[0]=d[0].replace(u,"/"),t=d.join(o);var c=t;if(c=c.trim(),!r&&1===t.split("#").length){var f=Po.exec(c);if(f)return e.path=c,e.href=c,e.pathname=f[1],f[2]?(e.search=f[2],e.query=n?Ga(e.search.substr(1)):e.search.substr(1)):n&&(e.search="",e.query={}),e}var g=To.exec(c);if(g){g=g[0];var m=g.toLowerCase();e.protocol=m,c=c.substr(g.length)}if(r||g||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var y="//"===c.substr(0,2);y&&!(g&&Wo[g])&&(c=c.substr(2),e.slashes=!0)}var b,w,_,E;if(!Wo[g]&&(y||g&&!Ho[g])){var S=-1;for(b=0;b<zo.length;b++)w=c.indexOf(zo[b]),-1!==w&&(-1===S||w<S)&&(S=w);var v,x;for(x=-1===S?c.lastIndexOf("@"):c.lastIndexOf("@",S),-1!==x&&(v=c.slice(0,x),c=c.slice(x+1),e.auth=decodeURIComponent(v)),S=-1,b=0;b<Uo.length;b++)w=c.indexOf(Uo[b]),-1!==w&&(-1===S||w<S)&&(S=w);-1===S&&(S=c.length),e.host=c.slice(0,S),c=c.slice(S),Jo(e),e.hostname=e.hostname||"";var R="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!R){var I=e.hostname.split(/\./);for(b=0,_=I.length;b<_;b++){var C=I[b];if(C&&!C.match(Fo)){for(var A="",L=0,B=C.length;L<B;L++)A+=127<C.charCodeAt(L)?"x":C[L];if(!A.match(Fo)){var k=I.slice(0,b),q=I.slice(b+1),T=C.match(No);T&&(k.push(T[1]),q.unshift(T[2])),q.length&&(c="/"+q.join(".")+c),e.hostname=k.join(".");break}}}}e.hostname=255<e.hostname.length?"":e.hostname.toLowerCase(),R||(e.hostname=Bo(e.hostname)),E=e.port?":"+e.port:"";var P=e.hostname||"";e.host=P+E,e.href+=e.host,R&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==c[0]&&(c="/"+c))}if(!Ko[m])for(b=0,_=Mo.length;b<_;b++){var h=Mo[b];if(-1!==c.indexOf(h)){var O=encodeURIComponent(h);O===h&&(O=escape(h)),c=c.split(h).join(O)}}var D=c.indexOf("#");-1!==D&&(e.hash=c.substr(D),c=c.slice(0,D));var M=c.indexOf("?");if(-1===M?n&&(e.search="",e.query={}):(e.search=c.substr(M),e.query=c.substr(M+1),n&&(e.query=Ga(e.query)),c=c.slice(0,M)),c&&(e.pathname=c),Ho[m]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){E=e.pathname||"";var U=e.search||"";e.path=E+U}return e.href=Vo(e),e}function Vo(e){var t=e.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var n=e.protocol||"",r=e.pathname||"",a=e.hash||"",o=!1,i="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&Ht(e.query)&&Object.keys(e.query).length&&(i=Ka(e.query));var s=e.search||i&&"?"+i||"";return n&&":"!==n.substr(-1)&&(n+=":"),e.slashes||(!n||Ho[n])&&!1!=o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):!o&&(o=""),a&&"#"!==a.charAt(0)&&(a="#"+a),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),n+o+r+s+a}qo.prototype.format=function(){return Vo(this)},qo.prototype.resolve=function(e){return this.resolveObject(Go(e,!1,!0)).format()},qo.prototype.resolveObject=function(e){if(Ft(e)){var t=new qo;t.parse(e,!1,!0),e=t}for(var n,r=new qo,a=Object.keys(this),o=0;o<a.length;o++)n=a[o],r[n]=this[n];if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var d,l=Object.keys(e),u=0;u<l.length;u++)d=l[u],"protocol"!==d&&(r[d]=e[d]);return Ho[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}var h;if(e.protocol&&e.protocol!==r.protocol){if(!Ho[e.protocol]){for(var c,f=Object.keys(e),g=0;g<f.length;g++)c=f[g],r[c]=e[c];return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!Wo[e.protocol]){for(h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),2>h.length&&h.unshift(""),r.pathname=h.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",p=r.search||"";r.path=m+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var s=r.pathname&&"/"===r.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=y||s||r.host&&e.pathname,w=b,_=r.pathname&&r.pathname.split("/")||[],E=r.protocol&&!Ho[r.protocol];h=e.pathname&&e.pathname.split("/")||[],E&&(r.hostname="",r.port=null,r.host&&(""===_[0]?_[0]=r.host:_.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),b=b&&(""===h[0]||""===_[0]));var S;if(y)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,_=h;else if(h.length)_||(_=[]),_.pop(),_=_.concat(h),r.search=e.search,r.query=e.query;else if(!zt(e.search))return E&&(r.hostname=r.host=_.shift(),S=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"),S&&(r.auth=S.shift(),r.host=r.hostname=S.shift())),r.search=e.search,r.query=e.query,Ut(r.pathname)&&Ut(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!_.length)return r.pathname=null,r.path=r.search?"/"+r.search:null,r.href=r.format(),r;for(var x=_.slice(-1)[0],R=(r.host||e.host||1<_.length)&&("."===x||".."===x)||""===x,I=0,C=_.length;0<=C;C--)x=_[C],"."===x?_.splice(C,1):".."===x?(_.splice(C,1),I++):I&&(_.splice(C,1),I--);if(!b&&!w)for(;I--;I)_.unshift("..");b&&""!==_[0]&&(!_[0]||"/"!==_[0].charAt(0))&&_.unshift(""),R&&"/"!==_.join("/").substr(-1)&&_.push("");var A=""===_[0]||_[0]&&"/"===_[0].charAt(0);return E&&(r.hostname=r.host=A?"":_.length?_.shift():"",S=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"),S&&(r.auth=S.shift(),r.host=r.hostname=S.shift())),b=b||r.host&&_.length,b&&!A&&_.unshift(""),_.length?r.pathname=_.join("/"):(r.pathname=null,r.path=null),Ut(r.pathname)&&Ut(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},qo.prototype.parseHost=function(){return Jo(this)};function Jo(e){var t=e.host,n=jo.exec(t);n&&(n=n[0],":"!==n&&(e.port=n.substr(1)),t=t.substr(0,t.length-n.length)),t&&(e.hostname=t)}var Qo=kr.Transform;function Zo(e){return this instanceof Zo?void(this._toSkip=e.skip,Qo.call(this,e)):new Zo(e)}$a.inherits(Zo,Qo),Zo.prototype._transform=function(e,t,n){0==this._toSkip?this.push(e):this._toSkip>e.length?this._toSkip-=e.length:(this._toSkip!==e.length&&this.push(e.slice(this._toSkip)),this._toSkip=0),n()};var $o=Zo;let ei;class ti extends ot{constructor(e){super(),this.checkConstructorArgument(e.downloadId),this.checkConstructorArgument(e.key),this.checkConstructorArgument(e.loadedFile),this.downloadId=e.downloadId,this.key=e.key?Vr(e.key):null,this.type=e.directory?1:0,this.directory=!!e.directory,ei||(ei=new Za(!1)),this.api=ei,this.loadedFile=e.loadedFile}checkConstructorArgument(e){if("string"==typeof e&&!/^[\w-]+$/.test(e))throw Error("Invalid argument: \"".concat(e,"\""))}loadMetadata(e,t){if(this.size=t.s||0,this.timestamp=t.ts||0,this.type=t.t,this.directory=!!t.t,this.owner=t.u,this.name=null,e&&t.k){const n=t.k.split(":");this.key=Vr(n[n.length-1]),e.decryptECB(this.key),t.a&&this.decryptAttributes(t.a)}}decryptAttributes(e){return this.key?(e=Qr(e),Zr(this.key).decryptCBC(e),e=ti.unpackAttributes(e),this.parseAttributes(e),this):this}parseAttributes(e){this.attributes=e,this.name=e.n,this.label=ni[e.lbl||0],this.favorited=!!e.fav}loadAttributes(e){"function"!=typeof e&&(e=e=>{if(e)throw e});const t=this.directory?{a:"f",c:1,ca:1,r:1,_querystring:{n:this.downloadId}}:{a:"g",p:this.downloadId};return this.api.request(t,(t,n)=>{if(t)return e(t);if(this.directory){const t=Object.create(null),r=n.f,a=r.find(e=>e.k&&e.h===e.k.split(":")[0]),o=this.key?new Gr(this.key):null;this.nodeId=a.h,this.timestamp=a.ts,t[a.h]=this;for(let e of r){if(e===a)continue;const n=new ti(e,this.storage);n.loadMetadata(o,e),n.downloadId=[this.downloadId,e.h],t[e.h]=n}for(let e of r){const n=t[e.p];if(n){const r=t[e.h];n.children||(n.children=[]),n.children.push(r),r.parent=n}}if(this.loadMetadata(o,a),this.loadedFile){const n=t[this.loadedFile];"undefined"==typeof n?e(Error("Node (file or folder) not found in folder")):e(null,n)}else e(null,this)}else{this.size=n.s;try{this.decryptAttributes(n.at)}catch(t){return e(t)}e(null,this)}}),this}download(e,t){"function"==typeof e&&(t=e,e={}),e||(e={});const n=e.start||0,a=e.returnCiphertext?n:n-n%16;let o=e.end||null;const r=e.maxConnections||4,i=e.initialChunkSize||131072,s=e.chunkSizeIncrement||131072,d=e.maxChunkSize||1048576,l={a:"g",g:1,ssl:2};if(this.nodeId?l.n=this.nodeId:Array.isArray(this.downloadId)?(l._querystring={n:this.downloadId[0]},l.n=this.downloadId[1]):l.p=this.downloadId,this.directory)throw Error("Can't download: folder download isn't supported");if(!this.key&&!e.returnCiphertext)throw Error("Can't download: key isn't defined");const p=this.key&&!e.returnCiphertext?ea(this.key,{start:a,disableVerification:0!==a||null!==o}):new wr,u=a===n?p:p.pipe(new $o({skip:n-a})),h=this.api||ei,c=e.requestModule||this.api.requestModule;return h.request(l,(e,t)=>{function l(e){if(200!==e.statusCode){if(509===e.statusCode){const t=e.headers["x-mega-time-left"],n=Error("Bandwidth limit reached: "+t+" seconds until it resets");return n.timeLimit=t,void u.emit("error",n)}u.emit("error",Error("MEGA returned a "+e.statusCode+" status code"))}}function h(e){u.emit("error",Error("Connection error: "+e.message))}if(e)return u.emit("error",e);if("string"!=typeof t.g||"http"!==t.g.substr(0,4))return u.emit("error",Error("MEGA servers returned an invalid response, maybe caused by rate limit"));if(o||(o=t.s-1),n>o)return u.emit("error",Error("You can't download past the end of the file."));if(1===r){const e=c(t.g+"/"+a+"-"+o);e.on("error",h),e.on("response",l),e.pipe(p),u.on("close",()=>{e.abort()})}else{const e=io.create();let n=a,f=i,g=!1;u.on("error",()=>{g=!0}),u.on("close",()=>{g=!0});const m=function a(){if(!g){const i=Math.min(o,n+f-1);if(!(i<n)){const o=c(t.g+"/"+n+"-"+i);o.on("end",a),o.on("error",h),o.on("response",l),e.append(o),n=i+1,f<d&&(f+=s)}}};e.on("error",e=>u.emit("error",e));for(let e=0;e<r;e++)m();e.pipe(p)}let f=0;u.on("data",e=>{f+=e.length,u.emit("progress",{bytesLoaded:f,bytesTotal:t.s})})}),t&&Dr(u,t),u}link(e,t){1===arguments.length&&"function"==typeof e&&(t=e,e={noKey:!1}),"boolean"==typeof e&&(e={noKey:e});let n="https://mega.nz/#".concat(this.directory?"F":"","!").concat(this.downloadId);!e.noKey&&this.key&&(n+="!".concat(Jr(this.key))),!e.noKey&&this.loadedFile&&(n+="!".concat(this.loadedFile)),t(null,n)}static fromURL(e){if("object"==typeof e)return new ti(e);const t=Go(e);if("mega.nz"!==t.hostname&&"mega.co.nz"!==t.hostname)throw Error("Invalid URL: wrong hostname");if(!t.hash)throw Error("Invalid URL: no hash");const n=t.hash.split("!");if("#"!==n[0]&&"#F"!==n[0])throw Error("Invalid URL: format not recognized");if(1>=n.length)throw Error("Invalid URL: too few arguments");if(n.length>=("#"===n[0]?4:5))throw Error("Invalid URL: too many arguments");return new ti({downloadId:n[1],key:n[2],directory:"#F"===n[0],loadedFile:n[3]})}static unpackAttributes(e){let t=0;for(;t<e.length&&e.readUInt8(t);)t++;if(e=e.slice(0,t).toString(),"MEGA{\""!==e.substr(0,6))throw Error("Attributes could not be decrypted with provided key.");return JSON.parse(e.substr(4))}}const ni=["","red","orange","yellow","green","blue","purple","grey"],ri={};class ai extends ti{constructor(e,t){if(super(e),this.storage=t,this.api=t.api,this.nodeId=e.h,this.timestamp=e.ts,this.type=e.t,this.directory=!!this.type,e.k){const n=e.k.split("/");let r=t.aes;for(let a of n){const n=a.split(":")[0];if(n===t.user){e.k=a;break}const o=t.shareKeys[n];if(o){e.k=a,r=ri[n],r||(r=ri[n]=new Gr(o));break}}this.loadMetadata(r,e)}}loadAttributes(){throw Error("This is not needed for files loaded from logged in sessions")}mkdir(e,t){function n(n){t&&t(n)}if(!this.directory)throw Error("node isn't a directory");if("string"==typeof e&&(e={name:e}),e.attributes||(e.attributes={}),e.name&&(e.attributes.n=e.name),!e.attributes.n)throw Error("file name is required");if(e.target||(e.target=this),e.key||(e.key=y.from(Nr(16))),16!==e.key.length)throw Error("wrong key length, must be 128bit");const r=e.key,a=ai.packAttributes(e.attributes);Zr(r).encryptCBC(a);const o=y.from(r);this.storage.aes.encryptECB(o);const i={a:"p",t:e.target.nodeId?e.target.nodeId:e.target,n:[{h:"xxxxxxxx",t:1,a:Jr(a),k:Jr(o)}]},s=si(this.storage.shareKeys,this);0<s.length&&(i.cr=oi(this.storage,[{nodeId:"xxxxxxxx",key:r}],s)),this.api.request(i,(e,r)=>{if(e)return n(e);const a=this.storage._importFile(r.f[0]);this.storage.emit("add",a),t&&t(null,a)})}upload(e,t,n){if(!this.directory)throw Error("node is not a directory");if(2===arguments.length&&"function"==typeof t&&([n,t]=[t,null]),"string"==typeof e&&(e={name:e}),e.attributes||(e.attributes={}),e.name&&(e.attributes.n=e.name),!e.attributes.n)throw Error("File name is required.");e.target||(e.target=this);let r,a=Vr(e.key);a||(a=Nr(24)),a instanceof y||(a=y.from(a));const o=e.uploadCiphertext?32:24;if(a.length!==o)throw Error("Wrong key length. Key must be 192bit");e.uploadCiphertext&&(r=a,a=ta(a).slice(0,24)),e.key=a;const i=[],s=(t,a,o,s)=>{if(t)return l(t);if(!o||0===o.length)return void l(Error("Server returned a invalid response while uploading"));const p=+o.toString();if(0>p)return void l(Error("Server returned error "+p+" while uploading"));if(i[a]=o,0!==a||r||(r=s.key),e.thumbnailImage&&!i[1])return;if(e.previewImage&&!i[2])return;if(!i[0])return;const u=ai.packAttributes(e.attributes);Zr(r).encryptCBC(u);const h=y.from(r);this.storage.aes.encryptECB(h);const c={h:Jr(i[0]),t:0,a:Jr(u),k:Jr(h)};1!==i.length&&(c.fa=i.slice(1).map((e,t)=>t+"*"+Jr(e)).filter(t=>t).join("/"));const f={a:"p",t:e.target.nodeId?e.target.nodeId:e.target,n:[c]},g=si(this.storage.shareKeys,this);0<g.length&&(f.cr=oi(this.storage,[{nodeId:c.h,key:r}],g)),this.api.request(f,(e,t)=>{if(e)return l(e);const r=this.storage._importFile(t.f[0]);this.storage.emit("add",r),d.emit("complete",r),n&&n(null,r)})};e.thumbnailImage&&this._uploadAttribute(e,e.thumbnailImage,1,s),e.previewImage&&this._uploadAttribute(e,e.previewImage,2,s);const d=this._upload(e,t,0,s),l=t=>{n?n(t):d.emit("error",t)};return d}_upload(e,t,n,r){const a=e.uploadCiphertext?Sr():$r(e.key),o=Sr().pause();let i=Or(o,a),s=e.size;return t&&"function"!=typeof t.pipe&&(s=t.length,i.end(t)),s?this._uploadWithSize(i,s,a,o,n,e,r):i=Or(Ur(t=>{this._uploadWithSize(i,t,a,o,n,e,r)}),i),t&&"function"==typeof t.pipe&&t.pipe(i),i}_uploadAttribute(e,t,n,r){const a=(t,a)=>{if(t)return r(t);const o=a.length,i=16*Math.ceil(o/16)-o;0!==i&&(a=y.concat([a,y.alloc(i)]));const s=e.handle?Zr(e.key):new Gr(e.key.slice(0,16));s.encryptCBC(a);const d=Sr().pause();let l=Or(d);l.end(a),this._uploadWithSize(l,a.length,l,d,n,e,r)};return t instanceof y?void a(null,t):void Dr(t,a)}_uploadWithSize(e,t,n,r,a,o,i){var s=Math.min;const d=0===a?{a:"u",ssl:2,s:t,ms:0,r:0,e:0,v:2}:{a:"ufa",ssl:2,s:t};o.handle&&(d.h=o.handle);const l=0===a?o.initialChunkSize||131072:t,p=o.chunkSizeIncrement||131072,u=o.maxChunkSize||1048576,h=o.maxConnections||4;let c,f,g,m,b,w=l,_=0,E=!1,k=0;const S=()=>{m=s(w,t-k),f=y.alloc(m),_++,w<u&&(w+=p),b=0,c&&(c.copy(f),b=s(c.length,m),c=c.length>m?c.slice(m):null),b===m?v():(E=!0,r.resume())},v=()=>{const r=this.api.requestModule({method:"POST",body:f,uri:g+"/"+(0===a?k:a-1),forever:!0});r.on("error",t=>{e.emit("error",Error("Connection error: "+t.message))}),r.on("response",t=>{200===t.statusCode||e.emit("error",Error("MEGA returned a "+t.statusCode+" status code"))}),f=null,k+=m,Dr(r,(e,r)=>{e||!r||0<r.length?(n.end(),i(e,a,r,n)):k<t&&!E&&S()}),k<t&&!E&&_<h&&S()};let x=0;n.on("data",n=>{x+=n.length,e.emit("progress",{bytesLoaded:x,bytesTotal:t}),n.copy(f,b),b+=n.length,b>=m&&(E=!1,r.pause(),c=n.slice(n.length-(b-m)),v())}),n.on("end",()=>{t&&x!==t&&e.emit("error",Error("Specified data size does not match: "+t+" !== "+x))}),this.api.request(d,(e,t)=>e?i(e):void(g=t.p,S()))}uploadAttribute(e,t,n){if("string"==typeof e&&(e=["thumbnail","preview"].indexOf(e)),0!==e&&1!==e)throw Error("Invalid attribute type");this._uploadAttribute({key:this.key,handle:this.nodeId},t,e+1,(t,r,a)=>{if(t)return n(t);const o={a:"pfa",n:this.nodeId,fa:e+"*"+Jr(a)};this.api.request(o,e=>e?n(e):void n(null,this))})}delete(e,t){return"function"==typeof e&&(t=e,e=void 0),"undefined"==typeof e&&(e=this.parent===this.storage.trash),e?this.api.request({a:"d",n:this.nodeId},t):this.moveTo(this.storage.trash,t),this}moveTo(e,t){if("string"==typeof e&&(e=this.storage.files[e]),!(e instanceof ti))throw Error("target must be a folder or a nodeId");const n={a:"m",n:this.nodeId,t:e.nodeId},r=si(this.storage.shareKeys,e);return 0<r.length&&(n.cr=oi(this.storage,[this],r)),this.api.request(n,t),this}setAttributes(e,t){Object.assign(this.attributes,e);const n=ai.packAttributes(this.attributes);return Zr(this.key).encryptCBC(n),this.api.request({a:"a",n:this.nodeId,at:Jr(n)},()=>{this.parseAttributes(this.attributes),t&&t()}),this}rename(e,t){return this.setAttributes({n:e},t),this}setLabel(e,t){if("string"==typeof e&&(e=ni.indexOf(e)),"number"!=typeof e||Math.floor(e)!==e||0>e||7<e)throw Error("label must be a integer between 0 and 7 or a valid label name");return this.setAttributes({lbl:e},t),this}setFavorite(e,t){return this.setAttributes({fav:e?1:0},t),this}link(e,t){1===arguments.length&&"function"==typeof e&&(t=e,e={noKey:!1}),"boolean"==typeof e&&(e={noKey:e});const n=e.__folderKey;return this.directory&&!n?(this.shareFolder(e,t),this):(this.api.request({a:"l",n:this.nodeId},(r,a)=>{if(r)return t(r);let o="https://mega.nz/#".concat(n?"F":"","!").concat(a);!e.noKey&&this.key&&(o+="!".concat(Jr(n||this.key))),t(null,o)}),this)}shareFolder(e,t){if(!this.directory)throw Error("node isn't a folder");const n=this.nodeId,r=this.storage.shareKeys[n];if(r)return this.link(Object.assign({__folderKey:r},e),t),this;let a=Vr(e.key);if(a||(a=Nr(16)),a instanceof y||(a=y.from(a)),16!==a.length)return void Re(()=>{t(Error("share key must be 16 byte / 22 characters"))});this.storage.shareKeys[n]=a;const o=y.from(n+n);this.storage.aes.encryptECB(o);const i={a:"s2",n:n,s:[{u:"EXP",r:0}],ok:Jr(this.storage.aes.encryptECB(y.from(a))),ha:Jr(o),cr:oi(this.storage,this)};return this.api.request(i,n=>n?t(n):void this.link(Object.assign({__folderKey:a},e),t)),this}unshareFolder(e,t){const n={a:"s2",n:this.nodeId,s:[{u:"EXP",r:""}]};return delete this.storage.shareKeys[this.nodeId],this.api.request(n,()=>{t&&t()}),this}importFile(e,t){if(!this.directory)throw Error("importFile can only be called on directories");if("string"==typeof e&&(e=ti.fromURL(e)),!(e instanceof ti))throw Error("First argument of importFile should be a File or a URL string");if(!e.key)return t(Error("Can't import files without encryption keys"));const n=(e,n)=>{if(e)return t(e);const r=ai.packAttributes(n.attributes);Zr(n.key).encryptCBC(r);const a=Array.isArray(n.downloadId)?n.downloadId[1]:n.downloadId,o={a:"p",t:this.nodeId,n:[{ph:a,t:0,a:Jr(r),k:Jr(this.storage.aes.encryptECB(n.key))}]};this.api.request(o,(e,n)=>{if(e)return t(e);const r=this.storage._importFile(n.f[0]);this.storage.emit("add",r),t&&t(null,r)})};return e.attributes?Re(n,null,e):e.loadAttributes(n),this}static packAttributes(e){let t=JSON.stringify(e);t=y.from("MEGA".concat(t));const n=y.alloc(16*Math.ceil(t.length/16));return t.copy(n),n}}function oi(e,t,n){const r=e.shareKeys;Array.isArray(t)||(t=ii(t)),n||(n=t.map(e=>si(r,e)).reduce((e,t)=>e.concat(t)).filter((e,t,n)=>t===n.indexOf(e)));const a=[n,t.map(e=>e.nodeId),[]];for(let o=n.length;o--;){const e=new Gr(r[n[o]]);for(let n=t.length;n--;){const r=y.from(t[n].key);r&&(32===r.length||16===r.length)&&a[2].push(o,n,Jr(e.encryptECB(r)))}}return a}function ii(e){return[e].concat((e.children||[]).map(ii).reduce((e,t)=>e.concat(t),[]))}function si(e,t){const n=t.nodeId,r=t.parent,a=[];return e[n]&&a.push(n),r?a.concat(si(e,r)):a}class di extends ot{constructor(e,t){if(super(),1===arguments.length&&"function"==typeof e&&(t=e,e={}),!e.email)throw Error("starting a session without credentials isn't supported");t||(t=e=>{if(e)throw e}),e.keepalive=void 0===e.keepalive||!!e.keepalive,e.autoload=void 0===e.autoload||!!e.autoload,e.autologin=void 0===e.autologin||!!e.autologin,this.api=new Za(e.keepalive),this.files={},this.options=e,e.autologin?this.login(t):Re(()=>t(null,this)),this.status="closed"}login(e){const t=()=>{this.status="ready",e(null,this),this.emit("ready",this)},n=e=>{this.api.request({a:"ug"},(n,r)=>n?e(n):void(this.name=r.name,this.user=r.u,this.options.autoload?this.reload(!0,n=>n?e(n):void t()):t()))};this.email=this.options.email.toLowerCase();const r=e=>{const t=Wr(y.from(this.options.password));delete this.options.password;const n=new Gr(t),r=Jr(n.stringhash(y.from(this.email))),a={a:"us",user:this.email,uh:r};o(a,n,e)},a=(e,t)=>{Hr(y.from(this.options.password),e,(e,n)=>{if(e)return t(e);delete this.options.password;const r=new Gr(n.slice(0,16)),a=Jr(n.slice(16)),i={a:"us",user:this.email,uh:a};o(i,r,t)})},o=(e,r,a)=>{this.api.request(e,(e,o)=>{if(e)return a(e);this.key=Vr(o.k),r.decryptECB(this.key),this.aes=new Gr(this.key);const i=Vr(o.csid),t=this.aes.decryptECB(Vr(o.privk)),s=Ca(t);if(!s)throw Error("invalid credentials");let d=Jr(Aa(i,s).slice(0,43));this.api.sid=this.sid=d,this.RSAPrivateKey=s,n(a)})};this.api.request({a:"us0",user:this.email},(t,n)=>t?e(t):1===n.v?r(e):2===n.v?a(n,e):void e(Error("Account version not supported"))),this.status="connecting"}reload(e,t){return"function"==typeof e&&([e,t]=[t,e]),"connecting"!==this.status||e?void(this.mounts=[],this.api.request({a:"f",c:1},(e,n)=>e?t(e):void(this.shareKeys=n.ok.reduce((e,t)=>{const n=t.h,r=this.aes.encryptECB(y.from(n+n));return ra(Vr(t.ha),r)&&(e[n]=this.aes.decryptECB(Vr(t.k))),e},{}),n.f.forEach(e=>this._importFile(e)),t(null,this.mounts))),this.api.on("sc",e=>{const t={};e.forEach(e=>{if("u"===e.a){const t=this.files[e.n];if(t){t.timestamp=e.ts;try{t.decryptAttributes(e.at)}catch(e){return e.file=t,void this.emit("file-decrypt-error",e)}t.emit("update"),this.emit("update",t)}}else"d"===e.a?t[e.n]=!0:"t"===e.a&&e.t.f.forEach(e=>{const n=this.files[e.h];if(n){delete t[e.h];const r=n.parent;if(r.nodeId===e.p)return;r.children.splice(r.children.indexOf(n),1),n.parent=this.files[e.p],n.parent.children||(n.parent.children=[]),n.parent.children.push(n),n.emit("move",r),this.emit("move",n,r)}else this.emit("add",this._importFile(e))})}),Object.keys(t).forEach(e=>{const t=this.files[e],n=t.parent;n.children.splice(n.children.indexOf(t),1),this.emit("delete",t),t.emit("delete")})})):this.once("ready",this.reload.bind(this,e,t))}_importFile(e){if(!this.files[e.h]){const t=this.files[e.h]=new ai(e,this);if(e.t===li&&(this.root=t,t.name="Cloud Drive"),e.t===ui&&(this.trash=t,t.name="Rubbish Bin"),e.t===pi&&(this.inbox=t,t.name="Inbox"),1<e.t&&this.mounts.push(t),e.p){let n=this.files[e.p];n.children||(n.children=[]),n.children.push(t),t.parent=n}}return this.files[e.h]}mkdir(e,t){return"ready"===this.status?this.root.mkdir(e,t):void this.on("ready",()=>this.root.mkdir(e,t))}upload(e,t,n){return"ready"===this.status?this.root.upload(e,t,n):void this.on("ready",()=>this.root.upload(e,t,n))}close(){this.status="closed",this.api.close()}getAccountInfo(e){this.api.request({a:"uq",strg:1,xfer:1,pro:1},(t,n)=>{t&&e(t);const r={};r.type=n.utype,r.spaceUsed=n.cstrg,r.spaceTotal=n.mstrg,r.downloadBandwidthTotal=n.mxfer||11258999068426240,r.downloadBandwidthUsed=n.caxfer||0,r.sharedBandwidthUsed=n.csxfer||0,r.sharedBandwidthLimit=n.srvratio,e(null,r)})}toJSON(){return{key:Jr(this.key),sid:this.sid,name:this.name,user:this.user,options:this.options}}static fromJSON(e){const t=new di(Object.assign(e.options,{autoload:!1,autologin:!1}));return t.key=Qr(e.key),t.aes=new Gr(t.key),t.api.sid=t.sid=e.sid,t.name=e.name,t.user=e.user,t}}const li=2,pi=3,ui=4,hi=ti.fromURL;export{di as Storage,ti as File,hi as file,$r as encrypt,ea as decrypt};